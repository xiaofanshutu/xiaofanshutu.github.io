

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="cutiebambi">
  <meta name="keywords" content="">
  
    <meta name="description" content="Spring Boot简介回顾什么是SpringSpring是一个开源框架，解决企业级应用开发的复杂性而创建的，简化开发。 Spring是为了解决企业级应用开发的复杂性而创建的，简化开发。 Spring是如何简化Java开发的为了降低Java开发的复杂性，Spring采用了以下4种关键策略： 1、基于POJO的轻量级和最小侵入性编程，所有东西都是bean； 2、通过IOC，依赖注入（DI）和面">
<meta property="og:type" content="article">
<meta property="og:title" content="Spring Boot">
<meta property="og:url" content="https://xiaofanshutu.github.io/posts/a541262a.html">
<meta property="og:site_name" content="caomeidafu">
<meta property="og:description" content="Spring Boot简介回顾什么是SpringSpring是一个开源框架，解决企业级应用开发的复杂性而创建的，简化开发。 Spring是为了解决企业级应用开发的复杂性而创建的，简化开发。 Spring是如何简化Java开发的为了降低Java开发的复杂性，Spring采用了以下4种关键策略： 1、基于POJO的轻量级和最小侵入性编程，所有东西都是bean； 2、通过IOC，依赖注入（DI）和面">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2022/09/25/SXEDxseJFpdowr6.png">
<meta property="og:image" content="https://s2.loli.net/2022/09/25/ZGEVRJv8qHnFYQz.png">
<meta property="og:image" content="https://s2.loli.net/2022/09/25/GPRiysJIupvK4Zr.png">
<meta property="og:image" content="https://s2.loli.net/2022/09/25/RidLrFC6oq82GBV.png">
<meta property="og:image" content="https://s2.loli.net/2022/09/25/svwmTKpEH1NjkUL.png">
<meta property="og:image" content="https://s2.loli.net/2022/09/25/6AxpMGfjri7CDRe.png">
<meta property="og:image" content="https://s2.loli.net/2022/09/25/EOoKq6Yr2GxJn3l.png">
<meta property="og:image" content="https://s2.loli.net/2022/09/25/7ivz5DPw8xJs6aK.png">
<meta property="og:image" content="https://s2.loli.net/2022/10/05/oLGNlFb1s7AXvi9.png">
<meta property="og:image" content="https://s2.loli.net/2022/10/05/dHGIlJ9jpOV7Dmt.png">
<meta property="og:image" content="https://s2.loli.net/2022/10/05/84jAb7cyzPlf2DZ.png">
<meta property="og:image" content="https://s2.loli.net/2022/10/05/25AIasoyvKgGhnF.png">
<meta property="og:image" content="https://s2.loli.net/2022/10/05/ukLd7EbSTDaGHv2.png">
<meta property="og:image" content="https://s2.loli.net/2022/10/05/fWuKNUy9kMHwPmI.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210061853136.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210061854400.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210061854523.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210061905924.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210061911767.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071417483.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071422994.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071429094.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071431472.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071438940.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071501321.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071451293.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071610326.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071620411.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071637954.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071651730.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071652696.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071832103.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071910057.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071910474.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071941989.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071946923.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071947922.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210081125289.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210081120596.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210081121773.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210081134780.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210090952395.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210090956477.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210090956942.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210090957717.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091001018.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091000847.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091009498.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091014916.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091027975.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091028653.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091454687.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091744055.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091744203.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091748306.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091751551.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091751261.png">
<meta property="og:image" content="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091752792.png">
<meta property="article:published_time" content="2023-04-29T01:07:41.747Z">
<meta property="article:modified_time" content="2024-01-17T23:40:27.670Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://s2.loli.net/2022/09/25/SXEDxseJFpdowr6.png">
  
  
  
  <title>Spring Boot - caomeidafu</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"xiaofanshutu.github.io","root":"/","version":"1.9.8","typing":{"enable":false,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 5.2.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="caomeidafu" type="application/atom+xml">
</head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 30vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>分类</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle">Spring Boot</span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-04-29 09:07" pubdate>
          2023年4月29日 上午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          16k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          134 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">Spring Boot</h1>
            
            
              <div class="markdown-body">
                
                <a id="more"></a>

<h1 id="Spring-Boot简介"><a href="#Spring-Boot简介" class="headerlink" title="Spring Boot简介"></a>Spring Boot简介</h1><h2 id="回顾什么是Spring"><a href="#回顾什么是Spring" class="headerlink" title="回顾什么是Spring"></a>回顾什么是Spring</h2><p>Spring是一个开源框架，解决企业级应用开发的复杂性而创建的，简化开发。</p>
<p><strong>Spring是为了解决企业级应用开发的复杂性而创建的，简化开发。</strong></p>
<h2 id="Spring是如何简化Java开发的"><a href="#Spring是如何简化Java开发的" class="headerlink" title="Spring是如何简化Java开发的"></a>Spring是如何简化Java开发的</h2><p>为了降低Java开发的复杂性，Spring采用了以下4种关键策略：</p>
<p>1、基于POJO的轻量级和最小侵入性编程，所有东西都是bean；</p>
<p>2、通过IOC，依赖注入（DI）和面向接口实现松耦合；</p>
<p>3、基于切面（AOP）和惯例进行声明式编程；</p>
<p>4、通过切面和模版减少样式代码，RedisTemplate，xxxTemplate；</p>
<h2 id="什么是Spring-Boot"><a href="#什么是Spring-Boot" class="headerlink" title="什么是Spring Boot"></a>什么是Spring Boot</h2><p>学过Java Web的同学就知道，开发一个web应用，从最初开始接触Servlet结合Tomcat, 跑出一个Hello Wolrld程序，是要经历特别多的步骤；后来就用了框架Struts，再后来是Spring MVC，到了现在的Spring Boot，过一两年又会有其他web框架出现；你们有经历过框架不断的演进，然后自己开发项目所有的技术也在不断的变化、改造吗？建议都可以去经历一遍；</p>
<p>言归正传，什么是Spring Boot呢，就是一个javaweb的开发框架，和Spring MVC类似，对比其他Java Web框架的好处，<strong>官方说是简化开发，约定大于配置（越是简化的东西，越是需要严格的规定）， you can “just run”</strong>，能迅速的开发web应用，几行代码开发一个http接口。</p>
<p>所有的技术框架的发展似乎都遵循了一条主线规律：从一个复杂应用场景 衍生 一种规范框架，人们只需要进行各种配置而不需要自己去实现它，这时候强大的配置功能成了优点；发展到一定程度之后，人们根据实际生产应用情况，选取其中实用功能和设计精华，重构出一些轻量级的框架；之后为了提高开发效率，嫌弃原先的各类配置过于麻烦，于是开始提倡“约定大于配置”，进而衍生出一些一站式的解决方案。</p>
<p>是的，这就是Java企业级应用-&gt;J2EE-&gt;Spring-&gt;Spring Boot的过程。</p>
<p>随着Spring不断的发展，涉及的领域越来越多，项目整合开发需要配合各种各样的文件，慢慢变得不那么易用简单，违背了最初的理念，甚至人称配置地狱。Spring Boot 正是在这样的一个背景下被抽象出来的开发框架，目的为了让大家更容易的使用Spring 、更容易的集成各种常用的中间件、开源软件；</p>
<p>Spring Boot 基于Spring开发，Spirng Boot 本身并不提供Spring框架的核心特性以及扩展功能，只是用于快速、敏捷地开发新一代基于Spring框架的应用程序。也就是说，它并不是用来替代Spring的解决方案，而是和Spring框架紧密结合用于提升Spring开发者体验的工具。<strong>Spring Boot 以约定大于配置的核心思想</strong>，默认帮我们进行了很多设置，多数Spring Boot应用只需要很少的Spring配置。同时它集成了大量常用的第三方库配置（例如 Redis、MongoDB、JPA、RabbitMQ、Quartz 等等），Spring Boot 应用中这些第三方库几乎可以零配置的开箱即用。</p>
<p>简单来说就是Spring Boot其实不是什么新的框架，它默认配置了很多框架的使用方式，就像maven整合了所有的jar包，Spring Boot整合了所有的框架 。</p>
<p>Spring Boot 出生名门，从一开始就站在一个比较高的起点，又经过这几年的发展，生态足够完善，Spring Boot已经当之无愧成为Java领域最热门的技术。</p>
<p><strong>Spring Boot的主要优点：</strong></p>
<ul>
<li>为所有Spring开发者更快的入门</li>
<li>开箱即用，提供各种默认配置来简化项目配置</li>
<li>内嵌式容器简化Web项目</li>
<li>没有冗余代码生成和XML配置的要求</li>
</ul>
<h1 id="微服务"><a href="#微服务" class="headerlink" title="微服务"></a>微服务</h1><h2 id="什么是微服务"><a href="#什么是微服务" class="headerlink" title="什么是微服务"></a>什么是微服务</h2><ul>
<li>微服务是一种架构风格，它要求我们在开发一个应用的时候，这个应用必须构建成一系列小服务的组合;可以通过http的方式进行互通。要说微服务架构，先得说说过去我们的单体应用架构。</li>
</ul>
<h2 id="单体应用架构"><a href="#单体应用架构" class="headerlink" title="单体应用架构"></a>单体应用架构</h2><ul>
<li>所谓单体应用架构(all in one)是指，我们将一个应用的中的所有应用服务都封装在一个应用中。</li>
<li>无论是ERP、CRM或是其他什么系统，你都把数据库访问，web访问, 等等各个功能放到一个war包内。（目前我们写的项目就是如此，将一个系统整体打包成war包）</li>
<li>这样做的好处是，易于开发和测试；也十分方便部署；当需要扩展时，只需要将war复制多份，然后放到多个服务器上，再做个负载均衡就可以了。</li>
<li>单体应用架构的缺点是，哪怕我要修改一个非常小的地方，我都需要停掉整个服务，重新打包、部署这个应用war包。特别是对于一个大型应用，我们不可能把所有内容都放在一个应用里面，我们如何维护、如何分工合作都是问题。</li>
</ul>
<h2 id="微服务架构"><a href="#微服务架构" class="headerlink" title="微服务架构"></a>微服务架构</h2><ul>
<li>all in one的架构方式，我们把所有的功能单元放在一个应用里面。然后我们把整个应用部署到服务器上。如果负载能力不行，我们将整个应用进行水平复制，进行扩展，然后在负载均衡。</li>
<li>所谓微服务架构，就是打破之前all in one的架构方式，把每个功能元素独立出来。把独立出来的功能元素的动态组合，需要的功能元素才去拿来组合，需要多一些时，可以整合多个功能元素。<strong>所以微服务架构是对功能元素进行复制，而没有对整个应用进行复制。</strong></li>
<li>这样做的好处是:<ul>
<li>节省了调用资源。</li>
<li>每个功能元素的服务都是一个可替换的、可独立升级的软件代码。</li>
</ul>
</li>
</ul>
<p><img src="https://s2.loli.net/2022/09/25/SXEDxseJFpdowr6.png" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>Martin Flower于2014年3月25日写的《Microservices》 ，详细的阐述了什么是微服务。<ul>
<li>原文地址: <a target="_blank" rel="noopener" href="http://martinfowler.com/articles/microservices.html">http://martinfowler.com/articles/microservices.html</a></li>
<li>翻译: <a target="_blank" rel="noopener" href="https://www.cnblogs.com/liuning8023/p/4493156.html">https://www.cnblogs.com/liuning8023/p/4493156.html</a></li>
</ul>
</li>
</ul>
<h2 id="如何构建微服务"><a href="#如何构建微服务" class="headerlink" title="如何构建微服务"></a>如何构建微服务</h2><ul>
<li><p>一个大型系统的微服务架构，就像一个复杂交织的神经网络，每-个神经元就是一个功能元素， 它们各自完成自己的功能，然后通过http相互请求调用。比如一个电商系统，查缓存、连数据库、浏览页面、结账、支付等服务都是一个个独立的功能服务,都被微化了，它们作为一个个微服务共同构建了一个庞大的系统。如果修改其中的一个功能，只需要更新升级其中一个功能服务单元即可。</p>
</li>
<li><p>但是这种庞大的系统架构给部署和运维带来很大的难度。于是，spring为我们带来了构建大型分布式微服务的全套、全程产品:</p>
<ul>
<li>构建一个个功能独立的微服务应用单元，可以使用springboot, 可以帮我们快速构建一个应用；</li>
<li>大型分布式网络服务的调用，这部分由spring cloud来完成，实现分布式；</li>
<li>在分布式中间,进行流式数据计算、批处理，我们有spring cloud data flow。</li>
<li>spring为我们想清楚了整个从开始构建应用到大型分布式应用全流程方案。</li>
</ul>
<p><img src="https://s2.loli.net/2022/09/25/ZGEVRJv8qHnFYQz.png" srcset="/img/loading.gif" lazyload></p>
</li>
</ul>
<h1 id="第一个SpringBoot程序"><a href="#第一个SpringBoot程序" class="headerlink" title="第一个SpringBoot程序"></a>第一个SpringBoot程序</h1><h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2><p>我们将学习如何快速的创建一个Spring Boot应用，并且实现一个简单的Http请求处理。通过这个例子对Spring Boot有一个初步的了解，并体验其结构简单、开发快速的特性。</p>
<p>我的环境准备：</p>
<ul>
<li>java version 1.8</li>
<li>Maven-3.6.1</li>
<li>SpringBoot 2.x 最新版</li>
</ul>
<p>开发工具：</p>
<ul>
<li>IDEA</li>
</ul>
<h2 id="创建基础项目说明"><a href="#创建基础项目说明" class="headerlink" title="创建基础项目说明"></a>创建基础项目说明</h2><p>Spring官方提供了非常方便的工具让我们快速构建应用（提供了一个快速生成的网站）</p>
<p>Spring Initializer：<a target="_blank" rel="noopener" href="https://start.spring.io/">https://start.spring.io/</a></p>
<p><strong>项目创建方式一：</strong> 使用Spring Initializer 的 Web页面创建项目</p>
<p>1、打开 <a target="_blank" rel="noopener" href="https://start.spring.io/">https://start.spring.io/</a></p>
<p>2、填写项目信息</p>
<p>3、点击”Generate Project“按钮生成项目；下载此项目</p>
<p>4、解压项目包，并用IDEA以Maven项目导入，一路下一步即可，直到项目导入完毕。</p>
<p>5、如果是第一次使用，可能速度会比较慢，包比较多、需要耐心等待一切就绪。</p>
<p><strong>项目创建方式二：</strong> 使用 IDEA 直接创建项目（idea继承了上面说的那个网站）</p>
<p>1、创建一个新项目</p>
<p>2、选择spring initalizr ， 可以看到默认就是去官网的快速构建工具那里实现</p>
<p>3、填写项目信息</p>
<p>4、选择初始化的组件（初学勾选 Web 即可）</p>
<p>5、填写项目路径</p>
<p>6、等待项目构建成功</p>
<p><strong>项目结构分析：</strong></p>
<p>通过上面步骤完成了基础项目的创建。就会自动生成以下文件。</p>
<p>1、程序的主启动类</p>
<p>2、一个 application.properties 配置文件</p>
<p>3、一个 测试类</p>
<p>4、一个 pom.xml</p>
<h2 id="pom-xml-分析"><a href="#pom-xml-分析" class="headerlink" title="pom.xml 分析"></a>pom.xml 分析</h2><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span> <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 有一个父项目 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.7.4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>/&gt;</span> <span class="hljs-comment">&lt;!-- lookup parent from repository --&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- gav坐标 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.example<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>hellospringboot<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>0.0.1-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>hellospringboot<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">description</span>&gt;</span>hellospringboot<span class="hljs-tag">&lt;/<span class="hljs-name">description</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">properties</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">java.version</span>&gt;</span>1.8<span class="hljs-tag">&lt;/<span class="hljs-name">java.version</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">properties</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- web依赖：集成tomcat, dispatcherServlet, xml...... --&gt;</span><br>        <span class="hljs-comment">&lt;!-- spring boot所有的依赖都是以spring-boot-starter为前缀的 --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- 单元测试 --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">scope</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">scope</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">build</span>&gt;</span><br>        <span class="hljs-comment">&lt;!-- 打jar包插件 --&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">plugins</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">plugin</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">plugin</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">plugins</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">build</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span><br><br></code></pre></td></tr></tbody></table></figure>



<p>如上所示，pom文件主要有四个部分:</p>
<ul>
<li><p>项目元数据信息：创建时候输入的Project Metadata部分，也就是Maven项目的基本元素，包括: groupld、 artifactld、 version、 name、 description等</p>
</li>
<li><p>parent：继承spring- boot -starter-parent的依赖管理，控制版本与打包等内容</p>
</li>
<li><p>dependencies： 项目具体依赖，这里包含了spring-boot-starter -web用于实现HTTP接口(该依赖中包含了Spring MVC)，官网对它的描述是:使用Spring MVC构建Web (包括RESTful)应用程序的入门者，使用Tomcat作为默认嵌入式容器。spring-boot-starter-test用于编写单元测试的依赖包。更多功能模块的使用我们将在后面逐步展开。</p>
</li>
<li><p>build: 构建配置部分。默认使用了spring-boot-maven-plugin,配合spring-boot-starter-parent就可以把Spring Boot应用打包成JAR来直接运行。</p>
<p><img src="https://s2.loli.net/2022/09/25/GPRiysJIupvK4Zr.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://s2.loli.net/2022/09/25/RidLrFC6oq82GBV.png" srcset="/img/loading.gif" lazyload></p>
</li>
</ul>
<h2 id="编写一个http接口"><a href="#编写一个http接口" class="headerlink" title="编写一个http接口"></a>编写一个http接口</h2><ol>
<li><p>在主程序的同级目录下，新建一个controller包，一定要在同级目录下，否则识别不到。</p>
</li>
<li><p>在包中新建一个HelloController类。</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.cutiebambi;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloController</span> </span>{<br>    <span class="hljs-meta">@RequestMapping("/hello")</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">hello</span><span class="hljs-params">()</span></span>{<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">"hello bambi"</span>;<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>



</li>
</ol>
<ol start="3">
<li><p>编写完毕后，从主程序启动项目，浏览器发起请求，看页面返回；</p>
<p><img src="https://s2.loli.net/2022/09/25/svwmTKpEH1NjkUL.png" srcset="/img/loading.gif" lazyload></p>
</li>
</ol>
<h2 id="点击-maven的-package-将项目打成jar包"><a href="#点击-maven的-package-将项目打成jar包" class="headerlink" title="点击 maven的 package, 将项目打成jar包"></a>点击 maven的 package, 将项目打成jar包</h2><ul>
<li><p>如果打包成功，则会在target目录下生成一个 jar 包</p>
<p><img src="https://s2.loli.net/2022/09/25/6AxpMGfjri7CDRe.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p>打成了jar包后，就可以在任何地方运行了。</p>
<p><img src="https://s2.loli.net/2022/09/25/EOoKq6Yr2GxJn3l.png" srcset="/img/loading.gif" lazyload></p>
</li>
</ul>
<h2 id="小技巧"><a href="#小技巧" class="headerlink" title="小技巧"></a>小技巧</h2><ul>
<li><p>更改tomcat端口号 ( resources 目录下的application.properties 文件)</p>
<figure class="highlight properties"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment">#更改项目端口号</span><br><span class="hljs-meta">server.port</span>=<span class="hljs-string">8089</span><br></code></pre></td></tr></tbody></table></figure>

<p><img src="https://s2.loli.net/2022/09/25/7ivz5DPw8xJs6aK.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p>更改启动时显示的字符拼成的字母：到项目下的 resources 目录下新建一个banner.txt 即可，将图案放在这个文件即可。</p>
</li>
</ul>
<h1 id="SpringBoo原理初探【重点】"><a href="#SpringBoo原理初探【重点】" class="headerlink" title="SpringBoo原理初探【重点】"></a>SpringBoo原理初探【重点】</h1><h2 id="pom-xml文件"><a href="#pom-xml文件" class="headerlink" title="pom.xml文件"></a>pom.xml文件</h2><h3 id="父依赖"><a href="#父依赖" class="headerlink" title="父依赖"></a>父依赖</h3><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- 有一个父项目 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.7.4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">relativePath</span>/&gt;</span> <span class="hljs-comment">&lt;!-- lookup parent from repository --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span><br></code></pre></td></tr></tbody></table></figure>



<p>点进spring-boot-starter-parent，它还有一个parent</p>
<p><artifactid>spring-boot-dependencies</artifactid>这个是核心依赖</p>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">parent</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-dependencies<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.7.4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">parent</span>&gt;</span><br></code></pre></td></tr></tbody></table></figure>

<p><strong>以后我们导入依赖默认是不需要写版本（因为有这些版本仓库）；但是如果导入的包没有在依赖中管理着就需要手动配置版本了；</strong></p>
<h3 id="启动器-spring-boot-starter"><a href="#启动器-spring-boot-starter" class="headerlink" title="启动器 spring-boot-starter"></a>启动器 spring-boot-starter</h3><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></tbody></table></figure>

<ul>
<li>springboot-boot-starter-xxx：就是spring-boot的场景启动器</li>
<li>spring-boot-starter-web：帮我们导入了web模块正常运行所依赖的组件；</li>
<li>SpringBoot将所有的功能场景都抽取出来，做成一个个的starter （启动器），如果我们想要使用什么样的功能，只需要在项目中引入相关的（启动器）starter即可，所有相关的依赖都会导入进来 ， 我们未来也可以自己自定义 starter；</li>
</ul>
<h2 id="主启动类-（看注解）"><a href="#主启动类-（看注解）" class="headerlink" title="主启动类 （看注解）"></a>主启动类 （看注解）</h2><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.cutiebambi;<br><br><span class="hljs-keyword">import</span> org.springframework.boot.SpringApplication;<br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;<br><br><span class="hljs-comment">//自动装配：启动类本身就是Spring的一个组件。</span><br><span class="hljs-comment">//SpringBootApplication标注这个类是一个spring boot的应用。启动类下的所有的资源被导入：EnableAutoConfiguration</span><br><span class="hljs-meta">@SpringBootApplication</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HellospringbootApplication</span> </span>{<br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>{<br>        SpringApplication.run(HellospringbootApplication.class, args);<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>

<p>@SpringBootApplication: 说明这个类是Spring Boot的主配置类。</p>
<h3 id="SpringBootConfiguration-Spring-Boot的配置类"><a href="#SpringBootConfiguration-Spring-Boot的配置类" class="headerlink" title="@SpringBootConfiguration: Spring Boot的配置类"></a>@SpringBootConfiguration: Spring Boot的配置类</h3><p>​    @Configuration: 配置类，对应的是Spring 的xml文件。</p>
<p>​        @Component</p>
<h3 id="EnableAutoConfiguration-开启自动配置功能"><a href="#EnableAutoConfiguration-开启自动配置功能" class="headerlink" title="@EnableAutoConfiguration: 开启自动配置功能"></a>@EnableAutoConfiguration: 开启自动配置功能</h3><p>​    @AutoConfigurationPackage: 自动配置包</p>
<p>​        @Import(AutoConfigurationPackages.Registrar.class): 自动配置包注册</p>
<p>​            @Import：Spring底层注解，给容器中导入一个组件。</p>
<p>​            Registrar.class: 将主启动类所在包及包下面所有子包里面的所有组件扫描到Spring容器。</p>
<p>​    @Import(AutoConfigurationImportSelector.class): 给容器中导入组件</p>
<p>​        AutoConfigurationImportSelector: 自动配置导入选择器</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">protected</span> List&lt;String&gt; <span class="hljs-title">getCandidateConfigurations</span><span class="hljs-params">(AnnotationMetadata metadata, AnnotationAttributes attributes)</span> </span>{<br>    List&lt;String&gt; configurations = <span class="hljs-keyword">new</span> ArrayList(SpringFactoriesLoader.loadFactoryNames(<span class="hljs-keyword">this</span>.getSpringFactoriesLoaderFactoryClass(), <span class="hljs-keyword">this</span>.getBeanClassLoader()));<br>    ImportCandidates.load(AutoConfiguration.class, <span class="hljs-keyword">this</span>.getBeanClassLoader()).forEach(configurations::add);<br>    Assert.notEmpty(configurations, <span class="hljs-string">"No auto configuration classes found in META-INF/spring.factories nor in META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports. If you are using a custom packaging, make sure that file is correct."</span>);<br>    <span class="hljs-keyword">return</span> configurations;<br>}<br></code></pre></td></tr></tbody></table></figure>


<p>上面的方法会调用下面这个方法</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> List&lt;String&gt; <span class="hljs-title">loadFactoryNames</span><span class="hljs-params">(Class&lt;?&gt; factoryType, <span class="hljs-meta">@Nullable</span> ClassLoader classLoader)</span> </span>{<br>    ClassLoader classLoaderToUse = classLoader;<br>    <span class="hljs-keyword">if</span> (classLoader ** <span class="hljs-keyword">null</span>) {<br>        classLoaderToUse = SpringFactoriesLoader.class.getClassLoader();<br>    }<br><br>    String factoryTypeName = factoryType.getName();<br>    <span class="hljs-keyword">return</span> (List)loadSpringFactories(classLoaderToUse).getOrDefault(factoryTypeName, Collections.emptyList());<br>}<br></code></pre></td></tr></tbody></table></figure>



<p>接着这个方法又会调用下面这个方法</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Map&lt;String, List&lt;String&gt;&gt; loadSpringFactories(ClassLoader classLoader) {<br>    Map&lt;String, List&lt;String&gt;&gt; result = (Map)cache.get(classLoader);<br>    <span class="hljs-keyword">if</span> (result != <span class="hljs-keyword">null</span>) {<br>        <span class="hljs-keyword">return</span> result;<br>    } <span class="hljs-keyword">else</span> {<br>        Map&lt;String, List&lt;String&gt;&gt; result = <span class="hljs-keyword">new</span> HashMap();<br><br>        <span class="hljs-keyword">try</span> {<br>            <span class="hljs-comment">//spring.factories这个是自动配置的核心文件</span><br>            <span class="hljs-comment">//自动配置真正实现是从classpath中搜寻所有的META-INF/spring.factories配置文件 ，并将其中对应的 	org.springframework.boot.autoconfigure. 包下的配置项，通过反射实例化为对应标注了 @Configuration的JavaConfig形式的IOC容器配置类 ， 然后将这些都汇总成为一个实例并加载到IOC容器中。小结：SpringBoot所有自动配置都是在启动的时候扫描并加载：spring.factories配置文件 ，所有的自动配置类都在这里面，但是不一定生效，要判断条件是否成立，而所谓的条件就是只要导入了对应的strater，就有对应的启动器了，有了启动器，条件成立，自动配置就生效，然后就配置成功！</span><br>            Enumeration&lt;URL&gt; urls = classLoader.getResources(<span class="hljs-string">"META-INF/spring.factories"</span>);<br><br>            <span class="hljs-keyword">while</span>(urls.hasMoreElements()) {<br>                URL url = (URL)urls.nextElement();<br>                UrlResource resource = <span class="hljs-keyword">new</span> UrlResource(url);<br>                Properties properties = PropertiesLoaderUtils.loadProperties(resource);<br>                Iterator var6 = properties.entrySet().iterator();<br><br>                <span class="hljs-keyword">while</span>(var6.hasNext()) {<br>                    Map.Entry&lt;?, ?&gt; entry = (Map.Entry)var6.next();<br>                    String factoryTypeName = ((String)entry.getKey()).trim();<br>                    String[] factoryImplementationNames = StringUtils.commaDelimitedListToStringArray((String)entry.getValue());<br>                    String[] var10 = factoryImplementationNames;<br>                    <span class="hljs-keyword">int</span> var11 = factoryImplementationNames.length;<br><br>                    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> var12 = <span class="hljs-number">0</span>; var12 &lt; var11; ++var12) {<br>                        String factoryImplementationName = var10[var12];<br>                        ((List)result.computeIfAbsent(factoryTypeName, (key) -&gt; {<br>                            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ArrayList();<br>                        })).add(factoryImplementationName.trim());<br>                    }<br>                }<br>            }<br><br>            result.replaceAll((factoryType, implementations) -&gt; {<br>                <span class="hljs-keyword">return</span> (List)implementations.stream().distinct().collect(Collectors.collectingAndThen(Collectors.toList(), Collections::unmodifiableList));<br>            });<br>            cache.put(classLoader, result);<br>            <span class="hljs-keyword">return</span> result;<br>        } <span class="hljs-keyword">catch</span> (IOException var14) {<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> IllegalArgumentException(<span class="hljs-string">"Unable to load factories from location [META-INF/spring.factories]"</span>, var14);<br>        }<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>




<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>SpringBoot在启动的时候从类路径下的META-INF/spring.factories中获取EnableAutoConfiguration指定的值将这些值作为自动配置类导入容器 ， 自动配置类就生效 ，以前我们需要自己配置的东西，现在SpringBoot 帮我们进行自动配置工作；整个J2EE的整体解决方案和自动配置都在spring-boot-autoconfigure的jar包中，他会把所有需要导入的组件，以类名（全限定名）的方式返回，这些类名对应的组件就会被添加到容器里；容器中有很多的xxxAutoConfiguration的文件（@Bean）, 就是这些类给容器中导入这个场景需要的所有组件 ， 并自动配置，@Configuration ；有了自动配置类 ， 免去了我们手动编写配置注入功能组件等的工作；</p>
<h1 id="yaml语法学习"><a href="#yaml语法学习" class="headerlink" title="yaml语法学习"></a>yaml语法学习</h1><h2 id="Spring-Boot的全局配置文件"><a href="#Spring-Boot的全局配置文件" class="headerlink" title="Spring Boot的全局配置文件"></a>Spring Boot的全局配置文件</h2><p>SpringBoot使用一个全局的配置文件 ， 配置文件名称是固定的。</p>
<ul>
<li><p>可以是application.properties</p>
<ul>
<li>语法结构：key=value</li>
</ul>
</li>
<li><p>也可以是application.yaml（官方推荐使用这个）</p>
<ul>
<li>语法结构: key: value（key和value之间的空格必须存在）</li>
</ul>
</li>
</ul>
<p><strong>配置文件的作用</strong>：修改Spring Boot自动配置的默认值。</p>
<h2 id="yaml概述"><a href="#yaml概述" class="headerlink" title="yaml概述"></a>yaml概述</h2><p>YAML是 “YAML Ain’t a Markup Language”</p>
<p><strong>这种语言以数据作为中心，而不是以标记语言为重点！</strong></p>
<p>以前的配置文件，大多数都是使用xml来配置；比如一个简单的端口配置，我们来对比下yaml和xml</p>
<p>传统xml配置：</p>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">server</span>&gt;</span>    <br>    <span class="hljs-tag">&lt;<span class="hljs-name">port</span>&gt;</span>8081<span class="hljs-tag">&lt;<span class="hljs-name">port</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">server</span>&gt;</span><br></code></pre></td></tr></tbody></table></figure>

<p>yaml配置：</p>
<figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">server:</span>  <br> <span class="hljs-attr">prot:</span> <span class="hljs-number">8080</span><br></code></pre></td></tr></tbody></table></figure>



<h2 id="yaml基础语法"><a href="#yaml基础语法" class="headerlink" title="yaml基础语法"></a>yaml基础语法</h2><ul>
<li><p>说明：语法要求严格！</p>
<ul>
<li>空格不能省略</li>
<li>以缩进来控制层级关系，只要是左边对齐的一列数据都是同一个层级的。</li>
<li>属性和值的大小写都是十分敏感的。</li>
</ul>
</li>
</ul>
<h3 id="字面量：普通的值-数字，布尔值，字符串"><a href="#字面量：普通的值-数字，布尔值，字符串" class="headerlink" title="字面量：普通的值 [ 数字，布尔值，字符串 ]"></a>字面量：普通的值 [ 数字，布尔值，字符串 ]</h3><ul>
<li>字面量直接写在后面就可以 ， 字符串默认不用加上双引号或者单引号；</li>
</ul>
<figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment">#yaml格式（注意空格）</span><br><span class="hljs-attr">k:</span> <span class="hljs-string">v</span><br></code></pre></td></tr></tbody></table></figure>

<ul>
<li><p>注意：</p>
<p>“ ” 双引号，不会转义字符串里面的特殊字符 ， 特殊字符会作为本身想表示的意思；比如 ：name: “kuang \n shen” 输出 ：kuang 换行 shen<br>’ ’ 单引号，会转义特殊字符 ， 特殊字符最终会变成和普通字符一样输出比如 ：name: ‘kuang \n shen’ 输出 ：kuang \n shen</p>
</li>
</ul>
<h3 id="对象、Map（键值对"><a href="#对象、Map（键值对" class="headerlink" title="对象、Map（键值对)"></a>对象、Map（键值对)</h3><figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment">#对象、Map格式</span><br><span class="hljs-attr">k:</span><br> <span class="hljs-attr">v1:</span>    <br> <span class="hljs-attr">v2:</span><br></code></pre></td></tr></tbody></table></figure>

<ul>
<li><p>在下一行来写对象的属性和值得关系，注意缩进；比如：</p>
<figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">student:</span><br> <span class="hljs-attr">name:</span> <span class="hljs-string">qinjiang</span>    <br> <span class="hljs-attr">age:</span> <span class="hljs-number">3</span><br></code></pre></td></tr></tbody></table></figure>
</li>
<li><p>行内写法</p>
<figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">student:</span> {<span class="hljs-attr">name:</span> <span class="hljs-string">qinjiang</span>,<span class="hljs-attr">age:</span> <span class="hljs-number">3</span>}<br></code></pre></td></tr></tbody></table></figure>





</li>
</ul>
<h3 id="数组（-List、set-）"><a href="#数组（-List、set-）" class="headerlink" title="数组（ List、set ）"></a>数组（ List、set ）</h3><ul>
<li><p>用 - 值表示数组中的一个元素,比如：</p>
<figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">pets:</span> <br> <span class="hljs-bullet">-</span> <span class="hljs-string">cat</span> <br> <span class="hljs-bullet">-</span> <span class="hljs-string">dog</span> <br> <span class="hljs-bullet">-</span> <span class="hljs-string">pig</span><br></code></pre></td></tr></tbody></table></figure>
</li>
<li><p>行内写法</p>
<figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">pets:</span> [<span class="hljs-string">cat</span>,<span class="hljs-string">dog</span>,<span class="hljs-string">pig</span>]<br></code></pre></td></tr></tbody></table></figure>

</li>
</ul>
<h3 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h3><figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment">#yaml文件可以存储的东西，重点对于空格的要求很严格</span><br><span class="hljs-comment"># 普通的键值对</span><br><span class="hljs-attr">name:</span> <span class="hljs-string">mengyuanshishabi</span><br><br><span class="hljs-comment"># 对象</span><br><span class="hljs-attr">student:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">mengyuan</span><br>  <span class="hljs-attr">age:</span> <span class="hljs-number">3</span><br><span class="hljs-comment">#行内表示</span><br><span class="hljs-attr">user:</span> {<span class="hljs-attr">name:</span> <span class="hljs-string">mengyuan</span>,<span class="hljs-attr">age:</span> <span class="hljs-number">3</span>}<br><br><span class="hljs-comment"># 数组</span><br><span class="hljs-attr">pets:</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">cat</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">pig</span><br>  <span class="hljs-bullet">-</span> <span class="hljs-string">dog</span><br><span class="hljs-comment"># 行内表示</span><br><span class="hljs-attr">pet:</span> [<span class="hljs-string">cat</span>,<span class="hljs-string">dog</span>,<span class="hljs-string">pig</span>]<br><br><span class="hljs-comment"># 而properties只能存键值对 key=value</span><br><span class="hljs-comment"># yaml格式文件的另一个强大之处，在于可以注入到我们的配置类中，下面会说。</span><br></code></pre></td></tr></tbody></table></figure>



<h2 id="注入配置文件"><a href="#注入配置文件" class="headerlink" title="注入配置文件"></a>注入配置文件</h2><h3 id="yaml注入配置文件"><a href="#yaml注入配置文件" class="headerlink" title="yaml注入配置文件"></a>yaml注入配置文件</h3><ol>
<li><p>在springboot项目中的resources目录下新建一个文件 application.yaml</p>
</li>
<li><p>编写一个实体类 Dog；</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.cutiebambi;<br><br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Value;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><br><span class="hljs-meta">@Component</span>  <span class="hljs-comment">//添加到spring 的组件里，注解生成&lt;bean&gt; ,在之前的开发中，也用注解来注入属性值</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dog</span> </span>{<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> Integer age;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>{<br>        <span class="hljs-keyword">return</span> name;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>{<br>        <span class="hljs-keyword">this</span>.name = name;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Integer <span class="hljs-title">getAge</span><span class="hljs-params">()</span> </span>{<br>        <span class="hljs-keyword">return</span> age;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setAge</span><span class="hljs-params">(Integer age)</span> </span>{<br>        <span class="hljs-keyword">this</span>.age = age;<br>    }<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>{<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">"Dog{"</span> +<br>            <span class="hljs-string">"name='"</span> + name + <span class="hljs-string">'\''</span> +<br>            <span class="hljs-string">", age="</span> + age +<br>            <span class="hljs-string">'}'</span>;<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>



</li>
</ol>
<ol start="3">
<li><p>思考，我们原来是如何给bean注入属性值的！@Value，给狗狗类测试一下：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Dog</span> </span>{<br>    <span class="hljs-meta">@Value("旺财")</span><br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-meta">@Value("3")</span><br>    <span class="hljs-keyword">private</span> Integer age;<br>}<br></code></pre></td></tr></tbody></table></figure>



</li>
</ol>
<ol start="4">
<li><p>在SpringBoot的测试类下注入狗狗输出一下；</p>
<p><img src="https://s2.loli.net/2022/10/05/oLGNlFb1s7AXvi9.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p>我们在编写一个复杂一点的实体类：Person 类</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.cutiebambi;<br><br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><br><span class="hljs-keyword">import</span> java.util.Date;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>{<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> Integer age;<br>    <span class="hljs-keyword">private</span> Boolean happy;<br>    <span class="hljs-keyword">private</span> Date birth;<br>    <span class="hljs-keyword">private</span> Map&lt;String,Object&gt; maps;<br>    <span class="hljs-keyword">private</span> List&lt;Object&gt; lists;<br>    <span class="hljs-keyword">private</span> Dog dog;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>{<br>        <span class="hljs-keyword">return</span> name;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>{<br>        <span class="hljs-keyword">this</span>.name = name;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Integer <span class="hljs-title">getAge</span><span class="hljs-params">()</span> </span>{<br>        <span class="hljs-keyword">return</span> age;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setAge</span><span class="hljs-params">(Integer age)</span> </span>{<br>        <span class="hljs-keyword">this</span>.age = age;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Boolean <span class="hljs-title">getHappy</span><span class="hljs-params">()</span> </span>{<br>        <span class="hljs-keyword">return</span> happy;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setHappy</span><span class="hljs-params">(Boolean happy)</span> </span>{<br>        <span class="hljs-keyword">this</span>.happy = happy;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Date <span class="hljs-title">getBirth</span><span class="hljs-params">()</span> </span>{<br>        <span class="hljs-keyword">return</span> birth;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setBirth</span><span class="hljs-params">(Date birth)</span> </span>{<br>        <span class="hljs-keyword">this</span>.birth = birth;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Map&lt;String, Object&gt; <span class="hljs-title">getMaps</span><span class="hljs-params">()</span> </span>{<br>        <span class="hljs-keyword">return</span> maps;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setMaps</span><span class="hljs-params">(Map&lt;String, Object&gt; maps)</span> </span>{<br>        <span class="hljs-keyword">this</span>.maps = maps;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Object&gt; <span class="hljs-title">getLists</span><span class="hljs-params">()</span> </span>{<br>        <span class="hljs-keyword">return</span> lists;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setLists</span><span class="hljs-params">(List&lt;Object&gt; lists)</span> </span>{<br>        <span class="hljs-keyword">this</span>.lists = lists;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Dog <span class="hljs-title">getDog</span><span class="hljs-params">()</span> </span>{<br>        <span class="hljs-keyword">return</span> dog;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setDog</span><span class="hljs-params">(Dog dog)</span> </span>{<br>        <span class="hljs-keyword">this</span>.dog = dog;<br>    }<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>{<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">"Person{"</span> +<br>                <span class="hljs-string">"name='"</span> + name + <span class="hljs-string">'\''</span> +<br>                <span class="hljs-string">", age="</span> + age +<br>                <span class="hljs-string">", happy="</span> + happy +<br>                <span class="hljs-string">", birth="</span> + birth +<br>                <span class="hljs-string">", maps="</span> + maps +<br>                <span class="hljs-string">", lists="</span> + lists +<br>                <span class="hljs-string">", dog="</span> + dog +<br>                <span class="hljs-string">'}'</span>;<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>



</li>
</ol>
<ol start="6">
<li><p>我们来使用yaml配置的方式进行注入，大家写的时候注意区别和优势，我们编写一个yaml配置！</p>
<figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">person:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">bambi</span><br>  <span class="hljs-attr">age:</span> <span class="hljs-number">9</span><br>  <span class="hljs-attr">happy:</span> <span class="hljs-literal">false</span><br>  <span class="hljs-attr">birth:</span> <span class="hljs-number">2022</span><span class="hljs-string">/02/12</span><br>  <span class="hljs-attr">maps:</span> {<span class="hljs-attr">key1:</span> <span class="hljs-string">value1</span>, <span class="hljs-attr">key2:</span> <span class="hljs-string">value2</span>}<br>  <span class="hljs-attr">lists:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">music</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">climbing</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">swimming</span><br>  <span class="hljs-attr">dog:</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">旺财</span><br>    <span class="hljs-attr">age:</span> <span class="hljs-number">3</span><br></code></pre></td></tr></tbody></table></figure>



</li>
</ol>
<ol start="7">
<li><p>我们刚才已经把person这个对象的所有值都写好了，我们现在来注入到我们的类中！</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">@ConfigurationProperties作用：</span><br><span class="hljs-comment">将配置文件中配置的每一个属性的值，映射到这个组件中；</span><br><span class="hljs-comment">告诉SpringBoot将本类中的所有属性和配置文件中相关的配置进行绑定</span><br><span class="hljs-comment">参数 prefix = “person” : 将配置文件中的person下面的所有属性和组件一一对应</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Component</span> <span class="hljs-comment">//注册bean</span><br><span class="hljs-meta">@ConfigurationProperties(prefix = "person")</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>{<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> Integer age;<br>    <span class="hljs-keyword">private</span> Boolean happy;<br>    <span class="hljs-keyword">private</span> Date birth;<br>    <span class="hljs-keyword">private</span> Map&lt;String,Object&gt; maps;<br>    <span class="hljs-keyword">private</span> List&lt;Object&gt; lists;<br>    <span class="hljs-keyword">private</span> Dog dog;<br>}<br></code></pre></td></tr></tbody></table></figure>



</li>
</ol>
<ol start="8">
<li><p>IDEA 提示，springboot配置注解处理器没有找到，让我们看文档，我们可以查看文档，找到一个依赖！</p>
<p><img src="https://s2.loli.net/2022/10/05/dHGIlJ9jpOV7Dmt.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-configuration-processor<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">optional</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">optional</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></tbody></table></figure>



</li>
</ol>
<ol start="9">
<li><p>确认以上配置都OK之后，我们去测试类中测试一下：</p>
<p>结果：所有值全部注入成功！</p>
<p><img src="https://s2.loli.net/2022/10/05/84jAb7cyzPlf2DZ.png" srcset="/img/loading.gif" lazyload></p>
</li>
</ol>
<h3 id="加载指定的配置文件"><a href="#加载指定的配置文件" class="headerlink" title="加载指定的配置文件"></a>加载指定的配置文件</h3><p><strong>@PropertySource ：</strong> 加载指定的配置文件；</p>
<p><strong>@configurationProperties</strong>：默认从全局配置文件中获取值；</p>
<p>1、我们去在resources目录下新建一个<strong>person.properties</strong>文件</p>
<figure class="highlight properties"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-attr">name</span>=<span class="hljs-string">bambi</span><br></code></pre></td></tr></tbody></table></figure>

<p>2、然后在我们的代码中指定加载teacher.properties文件properties</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.cutiebambi;<br><br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Value;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.PropertySource;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Component;<br><br><span class="hljs-meta">@Component</span><br><span class="hljs-meta">@PropertySource(value = "classpath:teacher.properties")</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Teacher</span> </span>{<br>    <span class="hljs-meta">@Value("${name}")</span><br>    <span class="hljs-keyword">private</span> String name;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getName</span><span class="hljs-params">()</span> </span>{<br>        <span class="hljs-keyword">return</span> name;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setName</span><span class="hljs-params">(String name)</span> </span>{<br>        <span class="hljs-keyword">this</span>.name = name;<br>    }<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">toString</span><span class="hljs-params">()</span> </span>{<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">"Teacher{"</span> +<br>                <span class="hljs-string">"name='"</span> + name + <span class="hljs-string">'\''</span> +<br>                <span class="hljs-string">'}'</span>;<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>

<p>3、再次输出测试一下：指定配置文件绑定成功！</p>
<p><img src="https://s2.loli.net/2022/10/05/25AIasoyvKgGhnF.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="配置文件占位符"><a href="#配置文件占位符" class="headerlink" title="配置文件占位符"></a>配置文件占位符</h3><figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">person:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">bambi${random.uuid}</span> <span class="hljs-comment"># 随机uuid</span><br>  <span class="hljs-attr">age:</span> <span class="hljs-string">${random.int}</span>  <span class="hljs-comment"># 随机int</span><br>  <span class="hljs-attr">happy:</span> <span class="hljs-literal">false</span><br>  <span class="hljs-attr">birth:</span> <span class="hljs-number">2022</span><span class="hljs-string">/02/12</span><br>  <span class="hljs-attr">maps:</span> {<span class="hljs-attr">key1:</span> <span class="hljs-string">value1</span>, <span class="hljs-attr">key2:</span> <span class="hljs-string">value2</span>}<br>  <span class="hljs-attr">lists:</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">music</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">climbing</span><br>    <span class="hljs-bullet">-</span> <span class="hljs-string">swimming</span><br>  <span class="hljs-attr">dog:</span><br>    <span class="hljs-attr">name:</span> <span class="hljs-string">旺财</span><br>    <span class="hljs-attr">age:</span> <span class="hljs-number">3</span><br></code></pre></td></tr></tbody></table></figure>

<p><img src="https://s2.loli.net/2022/10/05/ukLd7EbSTDaGHv2.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="对比小结"><a href="#对比小结" class="headerlink" title="对比小结"></a>对比小结</h3><p>配置yaml和配置properties都可以获取到值 ， 强烈推荐 yaml；</p>
<p>如果我们在某个业务中，只需要获取配置文件中的某个值，可以使用一下 @value；</p>
<p>如果说，我们专门编写了一个JavaBean来和配置文件进行一一映射，就直接@configurationProperties，不要犹豫！</p>
<h2 id="JSR303校验"><a href="#JSR303校验" class="headerlink" title="JSR303校验"></a>JSR303校验</h2><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/*</span><br><span class="hljs-comment">@ConfigurationProperties作用：</span><br><span class="hljs-comment">将配置文件中配置的每一个属性的值，映射到这个组件中；</span><br><span class="hljs-comment">告诉SpringBoot将本类中的所有属性和配置文件中相关的配置进行绑定</span><br><span class="hljs-comment">参数 prefix = “person” : 将配置文件中的person下面的所有属性一一对应</span><br><span class="hljs-comment">*/</span><br><span class="hljs-meta">@Component</span> <span class="hljs-comment">//注册bean</span><br><span class="hljs-meta">@ConfigurationProperties(prefix = "person")</span><br><span class="hljs-meta">@Validated</span>  <span class="hljs-comment">//数据校验</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Person</span> </span>{<br>    <span class="hljs-meta">@NotNull</span><br>    <span class="hljs-keyword">private</span> String name;<br>}<br></code></pre></td></tr></tbody></table></figure>

<p><img src="https://s2.loli.net/2022/10/05/fWuKNUy9kMHwPmI.png" srcset="/img/loading.gif" lazyload></p>
<h1 id="多环境切换"><a href="#多环境切换" class="headerlink" title="多环境切换"></a>多环境切换</h1><ul>
<li>profile是Spring对不同环境提供不同配置功能的支持，可以通过激活不同的环境版本，实现快速切换环境；</li>
</ul>
<h2 id="多配置文件"><a href="#多配置文件" class="headerlink" title="多配置文件"></a>多配置文件</h2><p>我们在主配置文件编写的时候，文件名可以是 application-{profile}.properties/yaml , 用来指定多个环境版本；</p>
<p>例如：</p>
<p>application-test.properties 代表测试环境配置</p>
<p>application-dev.properties 代表开发环境配置</p>
<p>但是Springboot并不会直接启动这些配置文件，它默认使用application.properties主配置文件；</p>
<figure class="highlight properties"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs properties"><span class="hljs-comment">#比如在配置文件中指定使用dev环境，我们可以通过设置不同的端口号进行测试；</span><br><span class="hljs-comment">#我们启动SpringBoot，就可以看到已经切换到dev下的配置了；</span><br><span class="hljs-meta">spring.profiles.active</span>=<span class="hljs-string">dev</span><br></code></pre></td></tr></tbody></table></figure>



<h2 id="yaml的多文档块"><a href="#yaml的多文档块" class="headerlink" title="yaml的多文档块"></a>yaml的多文档块</h2><p>和properties配置文件中一样，但是使用<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=yaml&amp;spm=1001.2101.3001.7020">yaml</a>去实现不需要创建多个配置文件，更加方便了 !</p>
<figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">8081</span><br><span class="hljs-comment">#选择要激活那个环境块</span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">profiles:</span><br>    <span class="hljs-attr">active:</span> <span class="hljs-string">prod</span><br><span class="hljs-meta">---</span><br><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">8083</span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">profiles:</span> <span class="hljs-string">dev</span> <span class="hljs-comment">#配置环境的名称</span><br><br><span class="hljs-meta">---</span><br><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">8084</span><br><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">profiles:</span> <span class="hljs-string">prod</span>  <span class="hljs-comment">#配置环境的名称</span><br></code></pre></td></tr></tbody></table></figure>

<p><strong>注意：如果yml和properties同时都配置了端口，并且没有激活其他环境 ， 默认会使用properties配置文件的！</strong></p>
<h2 id="配置文件加载位置"><a href="#配置文件加载位置" class="headerlink" title="配置文件加载位置"></a>配置文件加载位置</h2><p>官方文档说明：</p>
<p><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#features.external-config.files">https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#features.external-config.files</a></p>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210061853136.png" srcset="/img/loading.gif" lazyload></p>
<p>Spring Boot will automatically find and load <code>application.properties</code> and <code>application.yaml</code> files from the following locations when your application starts:</p>
<ol>
<li>From the classpath（类路径就是src/main/resource或者src/main/java，一般会把配置文件放在resource下。）<ol>
<li>The classpath root     优先级最低</li>
<li>The classpath <code>/config</code> package</li>
</ol>
</li>
<li>From the current directory<ol>
<li>The current directory</li>
<li>The <code>config/</code> subdirectory in the current directory</li>
<li>Immediate child directories of the <code>config/</code> subdirectory    优先级最高</li>
</ol>
</li>
</ol>
<h2 id="拓展，运维小技巧"><a href="#拓展，运维小技巧" class="headerlink" title="拓展，运维小技巧"></a>拓展，运维小技巧</h2><p>指定位置加载配置文件</p>
<p>我们还可以通过spring.config.location来改变默认的配置文件位置</p>
<p>项目打包好以后，我们可以使用命令行参数的形式，启动项目的时候来指定配置文件的新位置；这种情况，一般是后期运维做的多，相同配置，外部指定的配置文件优先级最高</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">java -jar spring-boot-config.jar --spring.config.location=F:/application.properties<br></code></pre></td></tr></tbody></table></figure>





<h1 id="自动配置原理【重点】"><a href="#自动配置原理【重点】" class="headerlink" title="自动配置原理【重点】"></a>自动配置原理【重点】</h1><ul>
<li>配置文件到底能写什么？怎么写？这个和spring.factories有什么关联？</li>
<li>SpringBoot官方文档中有大量的配置，我们无法全部记住</li>
</ul>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210061854400.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="分析自动配置原理"><a href="#分析自动配置原理" class="headerlink" title="分析自动配置原理"></a>分析自动配置原理</h2><p>从spring.factories中选择一个类进入，我们以<strong>HttpEncodingAutoConfiguration（Http编码自动配置）</strong> 为例解释自动配置原理；</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.cutiebambi;<br><br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.AutoConfiguration;<br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.condition.ConditionalOnClass;<br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;<br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.condition.ConditionalOnProperty;<br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.condition.ConditionalOnWebApplication;<br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.condition.ConditionalOnWebApplication.Type;<br><span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.web.ServerProperties;<br><span class="hljs-keyword">import</span> org.springframework.boot.context.properties.EnableConfigurationProperties;<br><span class="hljs-keyword">import</span> org.springframework.boot.web.server.WebServerFactoryCustomizer;<br><span class="hljs-keyword">import</span> org.springframework.boot.web.servlet.filter.OrderedCharacterEncodingFilter;<br><span class="hljs-keyword">import</span> org.springframework.boot.web.servlet.server.ConfigurableServletWebServerFactory;<br><span class="hljs-keyword">import</span> org.springframework.boot.web.servlet.server.Encoding;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.core.Ordered;<br><span class="hljs-keyword">import</span> org.springframework.web.filter.CharacterEncodingFilter;<br><br><span class="hljs-comment">//表示这是一个配置类，和以前编写的配置文件一样，也可以给容器中添加组件；</span><br><span class="hljs-meta">@AutoConfiguration</span><br><br><span class="hljs-comment">//进入这个ServerProperties查看，将配置文件中对应的值和ServerProperties绑定起来；</span><br><span class="hljs-comment">//并把ServerProperties加入到IOC容器中</span><br><br><span class="hljs-comment">//自动配置属性: 装配好之后，ServerProperties里面的属性就是我们要在配置文件中写的key了。</span><br><span class="hljs-meta">@EnableConfigurationProperties({ServerProperties.class})</span><br><br><span class="hljs-comment">//Spring的底层注解：根据不同条件，来判断当前配置或者类是否生效。如果满足指定的条件，整个配置类里面的配置就会生效；</span><br><span class="hljs-comment">//这里的意思就是判断当前应用是否是web应用，如果是，当前配置类生效</span><br><span class="hljs-meta">@ConditionalOnWebApplication(</span><br><span class="hljs-meta">        type = Type.SERVLET</span><br><span class="hljs-meta">)</span><br><br><span class="hljs-comment">//判断当前项目有没有这个类CharacterEncodingFilter；SpringMVC中进行乱码解决的过滤器；</span><br><span class="hljs-meta">@ConditionalOnClass({CharacterEncodingFilter.class})</span><br><br><span class="hljs-comment">//判断配置文件中是否存在某个配置：server.servlet.encoding.enabled；</span><br><span class="hljs-comment">//如果不存在，判断也是成立的</span><br><span class="hljs-comment">//即使我们配置文件中不配置server.servlet.encoding.enabled=true，也是默认生效的；</span><br><span class="hljs-meta">@ConditionalOnProperty(</span><br><span class="hljs-meta">        prefix = "server.servlet.encoding",</span><br><span class="hljs-meta">        value = {"enabled"},</span><br><span class="hljs-meta">        matchIfMissing = true</span><br><span class="hljs-meta">)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HttpEncodingAutoConfiguration</span> </span>{<br>    <span class="hljs-comment">//他已经和SpringBoot的配置文件映射了</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Encoding properties;<br><br>    <span class="hljs-comment">//只有一个有参构造器的情况下，参数的值就会从容器中拿</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">HttpEncodingAutoConfiguration</span><span class="hljs-params">(ServerProperties properties)</span> </span>{<br>        <span class="hljs-keyword">this</span>.properties = properties.getServlet().getEncoding();<br>    }<br><br>    <span class="hljs-comment">//给容器中添加一个组件，这个组件的某些值需要从properties中获取</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-meta">@ConditionalOnMissingBean</span> <span class="hljs-comment">//判断容器没有这个组件？</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> CharacterEncodingFilter <span class="hljs-title">characterEncodingFilter</span><span class="hljs-params">()</span> </span>{<br>        CharacterEncodingFilter filter = <span class="hljs-keyword">new</span> OrderedCharacterEncodingFilter();<br>        filter.setEncoding(<span class="hljs-keyword">this</span>.properties.getCharset().name());<br>        filter.setForceRequestEncoding(<span class="hljs-keyword">this</span>.properties.shouldForce(org.springframework.boot.web.servlet.server.Encoding.Type.REQUEST));<br>        filter.setForceResponseEncoding(<span class="hljs-keyword">this</span>.properties.shouldForce(org.springframework.boot.web.servlet.server.Encoding.Type.RESPONSE));<br>        <span class="hljs-keyword">return</span> filter;<br>    }<br><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-keyword">public</span> org.springframework.boot.autoconfigure.web.servlet.HttpEncodingAutoConfiguration.<span class="hljs-function">LocaleCharsetMappingsCustomizer <span class="hljs-title">localeCharsetMappingsCustomizer</span><span class="hljs-params">()</span> </span>{<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> org.springframework.boot.autoconfigure.web.servlet.HttpEncodingAutoConfiguration.LocaleCharsetMappingsCustomizer(<span class="hljs-keyword">this</span>.properties);<br>    }<br><br>    <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LocaleCharsetMappingsCustomizer</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">WebServerFactoryCustomizer</span>&lt;<span class="hljs-title">ConfigurableServletWebServerFactory</span>&gt;, <span class="hljs-title">Ordered</span> </span>{<br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Encoding properties;<br><br>        LocaleCharsetMappingsCustomizer(Encoding properties) {<br>            <span class="hljs-keyword">this</span>.properties = properties;<br>        }<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">customize</span><span class="hljs-params">(ConfigurableServletWebServerFactory factory)</span> </span>{<br>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.properties.getMapping() != <span class="hljs-keyword">null</span>) {<br>                factory.setLocaleCharsetMappings(<span class="hljs-keyword">this</span>.properties.getMapping());<br>            }<br><br>        }<br><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getOrder</span><span class="hljs-params">()</span> </span>{<br>            <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>        }<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>



<p><strong>一句话总结 ：根据当前不同的条件判断，决定这个配置类是否生效！</strong></p>
<ul>
<li>一但这个配置类生效；这个配置类就会给容器中添加各种组件；</li>
<li>这些组件的属性是从对应的properties类中获取的，这些类里面的每一个属性又是和配置文件（application.yaml）绑定的；</li>
<li>所有在配置文件中能配置的属性都是在xxxxProperties类中封装着；</li>
<li>配置文件能配置什么就可以参照某个功能对应的这个属性类</li>
</ul>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ConfigurationProperties(</span><br><span class="hljs-meta">    prefix = "server",</span><br><span class="hljs-meta">    ignoreUnknownFields = true</span><br><span class="hljs-meta">)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ServerProperties</span> </span>{<br>    <span class="hljs-keyword">private</span> Integer port;<br>    <span class="hljs-keyword">private</span> InetAddress address;<br>    <span class="hljs-meta">@NestedConfigurationProperty</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> ErrorProperties error = <span class="hljs-keyword">new</span> ErrorProperties();<br>    <span class="hljs-keyword">private</span> ForwardHeadersStrategy forwardHeadersStrategy;<br>    <span class="hljs-keyword">private</span> String serverHeader;<br>    <span class="hljs-keyword">private</span> DataSize maxHttpHeaderSize = DataSize.ofKilobytes(<span class="hljs-number">8L</span>);<br>    <span class="hljs-keyword">private</span> Shutdown shutdown;<br>    <span class="hljs-meta">@NestedConfigurationProperty</span><br>    <span class="hljs-keyword">private</span> Ssl ssl;<br>    <span class="hljs-meta">@NestedConfigurationProperty</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Compression compression;<br>    <span class="hljs-meta">@NestedConfigurationProperty</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Http2 http2;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Servlet servlet;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Reactive reactive;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Tomcat tomcat;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Jetty jetty;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Netty netty;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Undertow undertow;<br>}<br></code></pre></td></tr></tbody></table></figure>



<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210061854523.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment">#在配置文件中能够配置的东西，都存在一个固有的规律</span><br><span class="hljs-comment"># ***AutoConfiguration: 它们是容器中的一个个组件，最后都会加入到容器中。它们会帮我们自动装配东西，自动装配的东西有默认值，它会从***Properties里面去取默认值。</span><br><span class="hljs-comment"># ***Properties又和配置文件绑定，我们就可以使用自定义的配置了</span><br><br><span class="hljs-attr">server:</span><br>  <span class="hljs-attr">port:</span> <span class="hljs-number">9090</span><br>  <span class="hljs-attr">address:</span> <span class="hljs-string">test</span><br>  <span class="hljs-attr">ssl:</span><br>    <span class="hljs-attr">certificate:</span> <span class="hljs-string">test</span><br>    <span class="hljs-attr">enabled:</span> <span class="hljs-literal">false</span><br>    <span class="hljs-attr">enabled-protocols:</span> <span class="hljs-string">test</span><br>    <span class="hljs-attr">trust-store-type:</span> <span class="hljs-string">dsf</span><br>  <span class="hljs-attr">tomcat:</span><br>    <span class="hljs-attr">accept-count:</span> <span class="hljs-number">10</span><br></code></pre></td></tr></tbody></table></figure>

<p>这个就是自动装配的原理！！!</p>
<h2 id="精髓"><a href="#精髓" class="headerlink" title="精髓"></a>精髓</h2><p>1、SpringBoot启动会加载大量的自动配置类（xxxxAutoConfigurartion），每一个自动配置类中都有对应的 xxxxProperties，这些xxxxProperties中有着相关的属性与默认值，这些属性又是和配置文件（application.yaml）绑定的，所以我们可以通过配置文件来修改SpringBoot自动配置的默认值；</p>
<p>2、我们看我们需要的功能有没有在SpringBoot默认写好的自动配置类当中；</p>
<p>3、我们再来看这个自动配置类中到底配置了哪些组件；（只要我们要用的组件存在在其中，我们就不需要再手动配置了）</p>
<p>4、给容器中自动配置类添加组件的时候，会从properties类中获取某些属性。我们只需要在配置文件（application.yaml）中指定这些属性的值即可；</p>
<p><strong>xxxxAutoConfigurartion： 给容器中添加组件</strong></p>
<p>**xxxxProperties:自动配置类，封装配置文件中相关属性； **</p>
<h2 id="了解：-Conditional"><a href="#了解：-Conditional" class="headerlink" title="了解：@Conditional"></a>了解：@Conditional</h2><p>了解完自动装配的原理后，我们来关注一个细节问题，<strong>自动配置类必须在一定的条件下才能生效</strong>；</p>
<p><strong>@Conditional派生注解（Spring注解版原生的@Conditional作用）</strong></p>
<p>作用：必须是@Conditional指定的条件成立，才给容器中添加组件，配置配里面的所有内容才生效；</p>
<table>
<thead>
<tr>
<th>@Conditional扩展注解</th>
<th>作用（【判断是否满足当前条件）</th>
</tr>
</thead>
<tbody><tr>
<td>@ConditionalOnBean</td>
<td>容器中是否存在指定bean</td>
</tr>
<tr>
<td>@ConditionalOnClass</td>
<td>系统中有指定的类</td>
</tr>
<tr>
<td>@ConditionalOnExpression</td>
<td>满足SpEL表达式</td>
</tr>
<tr>
<td>@ConditionalOnJava</td>
<td>系统的Java版本是否符合要求</td>
</tr>
<tr>
<td>@ConditionalOnJndi</td>
<td>JNDI存在指定项</td>
</tr>
<tr>
<td>@ConditionalOnMissingBean</td>
<td>容器中不存在指定bean</td>
</tr>
<tr>
<td>@ConditionalOnMissingClass</td>
<td>系统中没有指定的类</td>
</tr>
<tr>
<td>@ConditionalOnNotWebApplication</td>
<td>当前不是web环境</td>
</tr>
<tr>
<td>@ConditionalOnProperty</td>
<td>系统中指定的属性是否有指定的值</td>
</tr>
<tr>
<td>@ConditionalOnResource</td>
<td>类路径下是否存在指定资源文件</td>
</tr>
<tr>
<td>@ConditionalOnWebApplication</td>
<td>当前是web环境</td>
</tr>
</tbody></table>
<p><strong>那么多的自动配置类，必须在一定的条件下才能生效；也就是说，我们加载了这么多的配置类，但不是所有的都生效了。</strong></p>
<p>我们怎么知道哪些自动配置类生效？</p>
<p><strong>我们可以通过启用 debug=true属性；来让控制台打印自动配置报告，这样我们就可以很方便的知道哪些自动配置类生效；</strong></p>
<figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-comment">#开启springboot的调试类</span><br><span class="hljs-string">debug=true</span><br></code></pre></td></tr></tbody></table></figure>

<p>输出的日志中大致分为一下几类：</p>
<p>Positive matches:（自动配置类启用的：正匹配） 已经启用了，并且生效的</p>
<p>Negative matches:（没有启动，没有匹配成功的自动配置类：负匹配）</p>
<p>Unconditional classes: （没有条件的类）</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java">Positive matches:<br>-----------------<br><br>   AopAutoConfiguration matched:<br>      - <span class="hljs-meta">@ConditionalOnProperty</span> (spring.aop.auto=<span class="hljs-keyword">true</span>) matched (OnPropertyCondition)<br>          <br>          <br>Negative matches:<br>-----------------<br><br>   ActiveMQAutoConfiguration:<br>      Did not match:<br>         - <span class="hljs-meta">@ConditionalOnClass</span> did not find required <span class="hljs-class"><span class="hljs-keyword">class</span> '<span class="hljs-title">javax</span>.<span class="hljs-title">jms</span>.<span class="hljs-title">ConnectionFactory</span>' (<span class="hljs-title">OnClassCondition</span>)</span><br><span class="hljs-class"></span><br><span class="hljs-class"></span><br>Unconditional classes:<br>----------------------<br><br>    org.springframework.boot.autoconfigure.context.ConfigurationPropertiesAutoConfiguration<br></code></pre></td></tr></tbody></table></figure>



<h1 id="SpringBoot-Web-开发前准备"><a href="#SpringBoot-Web-开发前准备" class="headerlink" title="SpringBoot Web 开发前准备"></a>SpringBoot Web 开发前准备</h1><ul>
<li>我们要解决的问题：<ul>
<li>导入静态资源，怎么样处理静态资源</li>
<li>首页index.jsp/index.html</li>
<li>Jsp,模板引擎Thymeleaf</li>
<li>装配扩展SpringMVC</li>
<li>增删改查</li>
<li>拦截器</li>
<li>国际化</li>
</ul>
</li>
</ul>
<h2 id="处理静态资源"><a href="#处理静态资源" class="headerlink" title="处理静态资源"></a>处理静态资源</h2><p>创建一个空的web工程</p>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210061905924.png" srcset="/img/loading.gif" lazyload></p>
<p>创建一个空web工程之后，先写一个测试controller验证有没有问题，没有问题的话再进行下一步。</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.cutiebambi;<br><br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;<br><br><span class="hljs-meta">@RestController</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HelloController</span> </span>{<br>    <span class="hljs-meta">@RequestMapping("/hello")</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">hello</span><span class="hljs-params">()</span></span>{<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">"hello bambi"</span>;<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>

<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210061911767.png" srcset="/img/loading.gif" lazyload></p>
<p>WebMvcAutoConfiguration.java 源码中关于静态资源的说明：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addResourceHandlers</span><span class="hljs-params">(ResourceHandlerRegistry registry)</span> </span>{<br>    <span class="hljs-comment">//1.如果我们在配置文件中自己定义了路径，下面默认的就会失效</span><br>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.resourceProperties.isAddMappings()) {<br>        logger.debug(<span class="hljs-string">"Default resource handling disabled"</span>);<br>    } <span class="hljs-keyword">else</span> {<br>        <span class="hljs-comment">//2.导入一些静态jar包，如jquery，这些jar包的目录结构要求，如果我们访问http://localhost:8080/webjars/... 就可以访问到/webjars下面的资源</span><br>        <span class="hljs-keyword">this</span>.addResourceHandler(registry, <span class="hljs-string">"/webjars/**"</span>, <span class="hljs-string">"classpath:/META-INF/resources/webjars/"</span>);<br>        <span class="hljs-comment">//3.源码中：staticPathPattern = "/**"，然后去查看WebProperties的Resources，private static final String[] CLASSPATH_RESOURCE_LOCATIONS = new String[]{"classpath:/META-INF/resources/", "classpath:/resources/", "classpath:/static/", "classpath:/public/"};</span><br>        <span class="hljs-keyword">this</span>.addResourceHandler(registry, <span class="hljs-keyword">this</span>.mvcProperties.getStaticPathPattern(), (registration) -&gt; {<br>            registration.addResourceLocations(<span class="hljs-keyword">this</span>.resourceProperties.getStaticLocations());<br>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.servletContext != <span class="hljs-keyword">null</span>) {<br>                ServletContextResource resource = <span class="hljs-keyword">new</span> ServletContextResource(<span class="hljs-keyword">this</span>.servletContext, <span class="hljs-string">"/"</span>);<br>                registration.addResourceLocations(<span class="hljs-keyword">new</span> Resource[]{resource});<br>            }<br><br>        });<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>



<p>总结：</p>
<ol>
<li><p>在SpringBoot中，我们可以使用以下几种方式处理静态资源</p>
<ul>
<li>webjars</li>
</ul>
<p>  [^浏览器访问的路径]: localhost:8080/webjars/</p>
<ul>
<li>public，static，/**, resources</li>
</ul>
<p>  [^浏览器访问的路径]: localhost:8080/</p>
</li>
</ol>
<ol start="2">
<li><p>优先级: resources &gt; static(默认) &gt; public</p>
</li>
<li><p>如果我们在配置文件（application.properties）中自己定义了路径，SpringBoot默认的路径就会失效，一般不建议这样做，因为它会直接return，代码不会往下走。</p>
</li>
<li><p><a target="_blank" rel="noopener" href="http://localhost:8080/webjars/%E2%80%A6">http://localhost:8080/webjars/…</a> 这个路径可以访问到/webjars下面的资源，一般会用于导入的依赖jar包的访问（这些依赖要去 webjars的官方网站：<a target="_blank" rel="noopener" href="https://www.webjars.org/">https://www.webjars.org</a> 去找），要求这些jar包的目录结构要求如下：</p>
</li>
</ol>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071417483.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.webjars<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>bootstrap<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.4.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></tbody></table></figure>

<p>​        在浏览器中访问通过webjars导入的静态资源：</p>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071422994.png" srcset="/img/loading.gif" lazyload></p>
<ol start="5">
<li><p>那我们项目中要是使用自己的静态资源该怎么导入呢？<br>我们去找staticPathPattern发现第二种映射规则 ：staticPathPattern = “/**” , 访问当前的项目任意资源，它会去找 WebProperties这个类 ,这个类在里面Resources定义了这些目录private static final String[] CLASSPATH_RESOURCE_LOCATIONS = new String[]{“classpath:/META-INF/resources/“, “classpath:/resources/“, “classpath:/static/“, “classpath:/public/“};<br>所以平常我们访问 <a target="_blank" rel="noopener" href="http://localhost:8080/%E2%80%A6">http://localhost:8080/…</a> ，它就会匹配到上述的目录，去这些目录下寻找资源。</p>
<p>创建三个js文件去验证这三个目录的优先级。<br><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071429094.png" srcset="/img/loading.gif" lazyload></p>
</li>
</ol>
<p>   访问localhost:8080/1.js，可以看到返回的是resources下面的js内容，可以得知：resources下面的静态资源优先级最高。<br>   <img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071431472.png" srcset="/img/loading.gif" lazyload></p>
<p>   接着把resources目录下的js删掉，继续访问localhost:8080/1.js。这一次返回的是static目录下的js内容。<br>   <img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071438940.png" srcset="/img/loading.gif" lazyload></p>
<p>   因此可以得出，优先级由高到低为：resources &gt; static &gt; public, 我们通常就把静态资源放在这三个目录下，至于怎样放，看个人习惯，很少使用/webjars。</p>
<h2 id="首页如何定制"><a href="#首页如何定制" class="headerlink" title="首页如何定制"></a>首页如何定制</h2><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> WelcomePageHandlerMapping <span class="hljs-title">welcomePageHandlerMapping</span><span class="hljs-params">(ApplicationContext applicationContext, FormattingConversionService mvcConversionService, ResourceUrlProvider mvcResourceUrlProvider)</span> </span>{<br>    WelcomePageHandlerMapping welcomePageHandlerMapping = <span class="hljs-keyword">new</span> WelcomePageHandlerMapping(<span class="hljs-keyword">new</span> TemplateAvailabilityProviders(applicationContext), applicationContext, <span class="hljs-keyword">this</span>.getWelcomePage(), <span class="hljs-keyword">this</span>.mvcProperties.getStaticPathPattern());<br>    welcomePageHandlerMapping.setInterceptors(<span class="hljs-keyword">this</span>.getInterceptors(mvcConversionService, mvcResourceUrlProvider));<br>    welcomePageHandlerMapping.setCorsConfigurations(<span class="hljs-keyword">this</span>.getCorsConfigurations());<br>    <span class="hljs-keyword">return</span> welcomePageHandlerMapping;<br>}<br><br><br><span class="hljs-function"><span class="hljs-keyword">private</span> Resource <span class="hljs-title">getWelcomePage</span><span class="hljs-params">()</span> </span>{<br>    String[] var1 = <span class="hljs-keyword">this</span>.resourceProperties.getStaticLocations();<br>    <span class="hljs-keyword">int</span> var2 = var1.length;<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> var3 = <span class="hljs-number">0</span>; var3 &lt; var2; ++var3) {<br>        String location = var1[var3];<br>        Resource indexHtml = <span class="hljs-keyword">this</span>.getIndexHtml(location);<br>        <span class="hljs-keyword">if</span> (indexHtml != <span class="hljs-keyword">null</span>) {<br>            <span class="hljs-keyword">return</span> indexHtml;<br>        }<br>    }<br><br>    ServletContext servletContext = <span class="hljs-keyword">this</span>.getServletContext();<br>    <span class="hljs-keyword">if</span> (servletContext != <span class="hljs-keyword">null</span>) {<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getIndexHtml((Resource)(<span class="hljs-keyword">new</span> ServletContextResource(servletContext, <span class="hljs-string">"/"</span>)));<br>    } <span class="hljs-keyword">else</span> {<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>    }<br>}<br><br><br><span class="hljs-function"><span class="hljs-keyword">private</span> Resource <span class="hljs-title">getIndexHtml</span><span class="hljs-params">(String location)</span> </span>{<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.getIndexHtml(<span class="hljs-keyword">this</span>.resourceLoader.getResource(location));<br>}<br><br><span class="hljs-function"><span class="hljs-keyword">private</span> Resource <span class="hljs-title">getIndexHtml</span><span class="hljs-params">(Resource location)</span> </span>{<br>    <span class="hljs-keyword">try</span> {<br>        Resource resource = location.createRelative(<span class="hljs-string">"index.html"</span>);<br>        <span class="hljs-keyword">if</span> (resource.exists() &amp;&amp; resource.getURL() != <span class="hljs-keyword">null</span>) {<br>            <span class="hljs-keyword">return</span> resource;<br>        }<br>    } <span class="hljs-keyword">catch</span> (Exception var3) {<br>    }<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>}<br></code></pre></td></tr></tbody></table></figure>

<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071501321.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071451293.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="Thymeleaf模板引擎"><a href="#Thymeleaf模板引擎" class="headerlink" title="Thymeleaf模板引擎"></a>Thymeleaf模板引擎</h2><h3 id="模板引擎"><a href="#模板引擎" class="headerlink" title="模板引擎"></a>模板引擎</h3><ul>
<li><p>前端交给我们的页面，是html页面。如果是我们以前开发，我们需要把他们转成jsp页面，jsp好处就是当我们查出一些数据转发到JSP页面以后，我们可以用jsp轻松实现数据的显示，及交互等。</p>
</li>
<li><p>jsp支持非常强大的功能，包括能写Java代码，但是呢，我们现在的这种情况，SpringBoot这个项目首先是以jar的方式，不是war，第二，我们用的还是嵌入式的Tomcat，所以呢，他现在默认是不支持jsp的。</p>
</li>
<li><p>那不支持jsp，如果我们直接用纯静态页面的方式，那给我们开发会带来非常大的麻烦，那怎么办呢？</p>
</li>
<li><p>SpringBoot推荐你可以来使用模板引擎：</p>
<ul>
<li>模板引擎，我们其实大家听到很多，其实jsp就是一个模板引擎，还有用的比较多的freemarker，包括SpringBoot给我们推荐的Thymeleaf，模板引擎有非常多，但再多的模板引擎，他们的思想都是一样的，什么样一个思想呢我们来看一下这张图：</li>
</ul>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071610326.png" srcset="/img/loading.gif" lazyload></p>
<p>模板引擎的作用就是我们来写一个页面模板，比如有些值呢，是动态的，我们写一些表达式。而这些值，从哪来呢，就是我们在后台封装一些数据。然后把这个模板和这个数据交给我们模板引擎，模板引擎按照我们这个数据帮你把这表达式解析、填充到我们指定的位置，然后把这个数据最终生成一个我们想要的内容给我们写出去，这就是我们这个模板引擎，不管是jsp还是其他模板引擎，都是这个思想。只不过呢，就是说不同模板引擎之间，他们可能这个语法有点不一样。其他的我就不介绍了，我主要来介绍一下SpringBoot给我们推荐的Thymeleaf模板引擎，这模板引擎呢，是一个高级语言的模板引擎，他的这个语法更简单。而且呢，功能更强大。<br>我们呢，就来看一下这个模板引擎，那既然要看这个模板引擎。首先，我们来看SpringBoot里边怎么用。</p>
</li>
</ul>
<h3 id="引入Thymeleaf"><a href="#引入Thymeleaf" class="headerlink" title="引入Thymeleaf"></a>引入Thymeleaf</h3><ul>
<li><p>怎么引入呢，对于springboot来说，什么事情不都是一个start的事情嘛，我们去在项目中引入一下。给大家三个网址：</p>
<ul>
<li>Thymeleaf 官网：<a target="_blank" rel="noopener" href="https://www.thymeleaf.org/">https://www.thymeleaf.org/</a></li>
<li>Thymeleaf 在Github 的主页：<a target="_blank" rel="noopener" href="https://github.com/thymeleaf/thymeleaf">https://github.com/thymeleaf/thymeleaf</a></li>
<li>Spring官方文档：找到我们对应的版本<a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/2.2.5.RELEASE/reference/htmlsingle/#using-boot-starter">https://docs.spring.io/spring-boot/docs/2.2.5.RELEASE/reference/htmlsingle/#using-boot-starter</a></li>
</ul>
</li>
<li><p>找到对应的pom依赖：可以适当点进源码看下本来的包！</p>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.springframework.boot<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>spring-boot-starter-thymeleaf<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></tbody></table></figure>



</li>
</ul>
<ul>
<li><p>Maven会自动下载jar包，我们可以去看下下载的东西；</p>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071620411.png" srcset="/img/loading.gif" lazyload></p>
</li>
</ul>
<h3 id="Thymeleaf分析"><a href="#Thymeleaf分析" class="headerlink" title="Thymeleaf分析"></a>Thymeleaf分析</h3><ul>
<li><p>前面呢，我们已经引入了Thymeleaf，那这个要怎么使用呢？</p>
</li>
<li><p>我们首先得按照SpringBoot的自动配置原理看一下我们这个Thymeleaf的自动配置规则，再按照那个规则，我们进行使用。我们去找一下Thymeleaf的自动配置类：ThymeleafProperties</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@ConfigurationProperties(</span><br><span class="hljs-meta">    prefix = "spring.thymeleaf"</span><br><span class="hljs-meta">)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ThymeleafProperties</span> </span>{<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> Charset DEFAULT_ENCODING;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String DEFAULT_PREFIX = <span class="hljs-string">"classpath:/templates/"</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> String DEFAULT_SUFFIX = <span class="hljs-string">".html"</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> checkTemplate = <span class="hljs-keyword">true</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> checkTemplateLocation = <span class="hljs-keyword">true</span>;<br>    <span class="hljs-keyword">private</span> String prefix = <span class="hljs-string">"classpath:/templates/"</span>;<br>    <span class="hljs-keyword">private</span> String suffix = <span class="hljs-string">".html"</span>;<br>    <span class="hljs-keyword">private</span> String mode = <span class="hljs-string">"HTML"</span>;<br>    <span class="hljs-keyword">private</span> Charset encoding;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> cache;<br>    <span class="hljs-keyword">private</span> Integer templateResolverOrder;<br>    <span class="hljs-keyword">private</span> String[] viewNames;<br>    <span class="hljs-keyword">private</span> String[] excludedViewNames;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> enableSpringElCompiler;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> renderHiddenMarkersBeforeCheckboxes;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">boolean</span> enabled;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Servlet servlet;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> Reactive reactive;<br>}<br></code></pre></td></tr></tbody></table></figure>



</li>
</ul>
<ul>
<li><p>我们可以在其中看到默认的前缀和后缀！</p>
</li>
<li><p>我们只需要把我们的html页面放在类路径下的templates下，thymeleaf就可以帮我们自动渲染了。</p>
</li>
<li><p>使用thymeleaf什么都不需要配置，只需要将他放在指定的文件夹下即可！</p>
</li>
</ul>
<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><ol>
<li><p>编写一个IndexController</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.cutiebambi;<br><br><span class="hljs-keyword">import</span> org.springframework.stereotype.Controller;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><br><span class="hljs-comment">//在templates目录下的所有页面，只能通过controller来跳转。</span><br><span class="hljs-comment">//这个需要模板引擎的支持！thymeleaf</span><br><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">IndexController</span> </span>{<br>    <span class="hljs-meta">@RequestMapping("/helloindex")</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">index</span><span class="hljs-params">()</span></span>{<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">"index"</span>;<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>



</li>
</ol>
<ol start="2">
<li>编写一个测试页面 index.html 放在 templates 目录下<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Hello Bambi<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    明天更好~~<br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></tbody></table></figure>



</li>
</ol>
<ol start="3">
<li><p>启动项目请求测试</p>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071637954.png" srcset="/img/loading.gif" lazyload></p>
</li>
</ol>
<h3 id="Thymeleaf-语法学习"><a href="#Thymeleaf-语法学习" class="headerlink" title="Thymeleaf 语法学习"></a>Thymeleaf 语法学习</h3><ul>
<li>要学习语法，还是参考官网文档最为准确，我们找到对应的版本看一下；</li>
<li>Thymeleaf 官网：<a target="_blank" rel="noopener" href="https://www.thymeleaf.org/">https://www.thymeleaf.org/</a> ， 简单看一下官网！我们去下载Thymeleaf的官方文档！</li>
<li><strong>我们做个最简单的练习 ：我们需要查出一些数据，在页面中展示</strong></li>
</ul>
<ol>
<li><p>修改测试请求，增加数据传输。</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.cutiebambi;<br><br><span class="hljs-keyword">import</span> org.springframework.stereotype.Controller;<br><span class="hljs-keyword">import</span> org.springframework.ui.Model;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><br><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TestController</span> </span>{<br>    <span class="hljs-meta">@RequestMapping("/test")</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">test</span><span class="hljs-params">(Model model)</span></span>{<br>        model.addAttribute(<span class="hljs-string">"msg"</span>, <span class="hljs-string">"你好呀，bambi！"</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">"test"</span>;<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>



</li>
</ol>
<ol start="2">
<li><p>我们要使用thymeleaf，需要在html文件中导入命名空间的约束，方便提示。我们可以去官方文档查一下然后把命名空间写进来。</p>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071651730.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">"http://www.thymeleaf.org"</span>&gt;</span><br></code></pre></td></tr></tbody></table></figure>



</li>
</ol>
<ol start="3">
<li><p>我们去编写下前端页面。</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-comment">&lt;!--命名空间的约束--&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">"http://www.thymeleaf.org"</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>test<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br>    <span class="hljs-comment">&lt;!--所有的html元素都可以被thymeleaf替换接管， th:元素名称 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">"${msg}"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></tbody></table></figure>



</li>
</ol>
<ol start="4">
<li>启动项目进行测试。</li>
</ol>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071652696.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="SpringMVC自动配置原理"><a href="#SpringMVC自动配置原理" class="headerlink" title="SpringMVC自动配置原理"></a>SpringMVC自动配置原理</h2><h3 id="官网阅读"><a href="#官网阅读" class="headerlink" title="官网阅读"></a>官网阅读</h3><ul>
<li><p>在进行项目编写前，我们还需要知道一个东西，就是SpringBoot对我们的SpringMVC还做了哪些配置，包括如何扩展，如何定制。</p>
</li>
<li><p>只有把这些都搞清楚了，我们在之后使用才会更加得心应手。<br>途径一：源码分析；<br>途径二：官方文档！</p>
</li>
<li><p>地址 ：<a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/2.7.4/reference/htmlsingle/#web.servlet.spring-mvc.auto-configuration">https://docs.spring.io/spring-boot/docs/2.7.4/reference/htmlsingle/#web.servlet.spring-mvc.auto-configuration</a></p>
</li>
</ul>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//Spring MVC自动配置</span><br>Spring MVC Auto-configuration<br><span class="hljs-comment">//Spring Boot为Spring MVC提供了自动配置，在大多数应用程序中都能很好地工作。</span><br>Spring Boot provides auto-configuration <span class="hljs-keyword">for</span> Spring MVC that works well with most applications.<br><span class="hljs-comment">//自动配置在Spring默认配置的基础上添加了以下特性:</span><br>The auto-configuration adds the following features on top of Spring’s defaults:<br><span class="hljs-comment">//包含ContentNegotiatingViewResolver和BeanNameViewResolver bean。</span><br>Inclusion of ContentNegotiatingViewResolver and BeanNameViewResolver beans.<br><span class="hljs-comment">//对提供静态资源的支持，包括对webjar的支持(在本文档后面介绍)。</span><br>Support <span class="hljs-keyword">for</span> serving <span class="hljs-keyword">static</span> resources, <span class="hljs-function">including support <span class="hljs-keyword">for</span> <span class="hljs-title">WebJars</span> <span class="hljs-params">(covered later in <span class="hljs-keyword">this</span> document)</span>.</span><br><span class="hljs-function"><span class="hljs-comment">//自动注册Converter、GenericConverter和Formatter bean。</span></span><br><span class="hljs-function">Automatic registration of Converter, GenericConverter, and Formatter beans.</span><br><span class="hljs-function"><span class="hljs-comment">//对HttpMessageConverters的支持(在本文档后面介绍)。</span></span><br><span class="hljs-function">Support <span class="hljs-keyword">for</span> <span class="hljs-title">HttpMessageConverters</span> <span class="hljs-params">(covered later in <span class="hljs-keyword">this</span> document)</span>.</span><br><span class="hljs-function"><span class="hljs-comment">//MessageCodesResolver的自动注册(在本文档后面介绍)。</span></span><br><span class="hljs-function">Automatic registration of <span class="hljs-title">MessageCodesResolver</span> <span class="hljs-params">(covered later in <span class="hljs-keyword">this</span> document)</span>.</span><br><span class="hljs-function"><span class="hljs-comment">//静态index . html的支持。</span></span><br><span class="hljs-function">Static index.html support.</span><br><span class="hljs-function"><span class="hljs-comment">//自动使用ConfigurableWebBindingInitializer bean(在本文档后面介绍)。</span></span><br><span class="hljs-function">Automatic use of a ConfigurableWebBindingInitializer <span class="hljs-title">bean</span> <span class="hljs-params">(covered later in <span class="hljs-keyword">this</span> document)</span>.</span><br><span class="hljs-function"><span class="hljs-comment">//如果你想保留那些Spring Boot MVC定制，并做更多的MVC定制(拦截器、格式化器、视图控制器和其他功能)，你可以添加你自己的WebMvcConfigurer类型的@Configuration类，但不需要@EnableWebMvc。</span></span><br><span class="hljs-function">If you want to keep those Spring Boot MVC customizations and make more MVC <span class="hljs-title">customizations</span> <span class="hljs-params">(interceptors, formatters, view controllers, and other features)</span>, you can add your own @Configuration class of type WebMvcConfigurer but without @EnableWebMvc.</span><br><span class="hljs-function"><span class="hljs-comment">//如果你想提供RequestMappingHandlerMapping, RequestMappingHandlerAdapter，或ExceptionHandlerExceptionResolver的自定义实例，并且仍然保持Spring引导MVC的自定义，你可以声明一个WebMvcRegistrations类型的bean，并使用它来提供这些组件的自定义实例。</span></span><br><span class="hljs-function">If you want to provide custom instances of RequestMappingHandlerMapping, RequestMappingHandlerAdapter, or ExceptionHandlerExceptionResolver, and still keep the Spring Boot MVC customizations, you can declare a bean of type WebMvcRegistrations and use it to provide custom instances of those components.</span><br><span class="hljs-function"><span class="hljs-comment">//如果你想完全控制Spring MVC，你可以添加你自己的@Configuration，带有@EnableWebMvc注解，或者添加你自己的@Configuration注解的DelegatingWebMvcConfiguration，就像@EnableWebMvc的Javadoc中描述的那样。</span></span><br><span class="hljs-function">If you want to take complete control of Spring MVC, you can add your own @Configuration annotated with @EnableWebMvc, or alternatively add your own @Configuration-annotated DelegatingWebMvcConfiguration as described in the Javadoc of @EnableWebMvc.</span><br></code></pre></td></tr></tbody></table></figure>

<p>我们来仔细对照，看一下它怎么实现的，它告诉我们SpringBoot已经帮我们自动配置好了SpringMVC，然后自动配置了哪些东西呢？</p>
<h3 id="ContentNegotiatingViewResolver-内容协商视图解析器"><a href="#ContentNegotiatingViewResolver-内容协商视图解析器" class="headerlink" title="ContentNegotiatingViewResolver 内容协商视图解析器"></a>ContentNegotiatingViewResolver 内容协商视图解析器</h3><p>自动配置了ViewResolver，就是我们之前学习的SpringMVC的视图解析器；</p>
<p>即根据方法的返回值取得视图对象（View），然后由视图对象决定如何渲染（转发，重定向）。</p>
<p>我们去看看这里的源码：我们找到 WebMvcAutoConfiguration ， 然后搜索ContentNegotiatingViewResolver。找到如下方法！</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span><br><span class="hljs-meta">@ConditionalOnBean({ViewResolver.class})</span><br><span class="hljs-meta">@ConditionalOnMissingBean(</span><br><span class="hljs-meta">    name = {"viewResolver"},</span><br><span class="hljs-meta">    value = {ContentNegotiatingViewResolver.class}</span><br><span class="hljs-meta">)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> ContentNegotiatingViewResolver <span class="hljs-title">viewResolver</span><span class="hljs-params">(BeanFactory beanFactory)</span> </span>{<br>    ContentNegotiatingViewResolver resolver = <span class="hljs-keyword">new</span> ContentNegotiatingViewResolver();<br>    resolver.setContentNegotiationManager((ContentNegotiationManager)beanFactory.getBean(ContentNegotiationManager.class));<br>    resolver.setOrder(Integer.MIN_VALUE);<br>    <span class="hljs-keyword">return</span> resolver;<br>}<br></code></pre></td></tr></tbody></table></figure>

<p>我们可以点进ContentNegotiatingViewResolver类看看！找到对应的解析视图的代码；</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//注解说明：@Nullable 即参数可为null</span><br><span class="hljs-meta">@Nullable</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> View <span class="hljs-title">resolveViewName</span><span class="hljs-params">(String viewName, Locale locale)</span> <span class="hljs-keyword">throws</span> Exception </span>{<br>    RequestAttributes attrs = RequestContextHolder.getRequestAttributes();<br>    Assert.state(attrs <span class="hljs-keyword">instanceof</span> ServletRequestAttributes, <span class="hljs-string">"No current ServletRequestAttributes"</span>);<br>    List&lt;MediaType&gt; requestedMediaTypes = <span class="hljs-keyword">this</span>.getMediaTypes(((ServletRequestAttributes)attrs).getRequest());<br>    <span class="hljs-keyword">if</span> (requestedMediaTypes != <span class="hljs-keyword">null</span>) {<br>        <span class="hljs-comment">//获取候选的视图对象</span><br>        List&lt;View&gt; candidateViews = <span class="hljs-keyword">this</span>.getCandidateViews(viewName, locale, requestedMediaTypes);<br>        <span class="hljs-comment">//选择一个最适合的视图对象，然后把这个对象返回</span><br>        View bestView = <span class="hljs-keyword">this</span>.getBestView(candidateViews, requestedMediaTypes, attrs);<br>        <span class="hljs-keyword">if</span> (bestView != <span class="hljs-keyword">null</span>) {<br>            <span class="hljs-keyword">return</span> bestView;<br>        }<br>    }<br><br>    String mediaTypeInfo = <span class="hljs-keyword">this</span>.logger.isDebugEnabled() &amp;&amp; requestedMediaTypes != <span class="hljs-keyword">null</span> ? <span class="hljs-string">" given "</span> + requestedMediaTypes.toString() : <span class="hljs-string">""</span>;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.useNotAcceptableStatusCode) {<br>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.logger.isDebugEnabled()) {<br>            <span class="hljs-keyword">this</span>.logger.debug(<span class="hljs-string">"Using 406 NOT_ACCEPTABLE"</span> + mediaTypeInfo);<br>        }<br><br>        <span class="hljs-keyword">return</span> NOT_ACCEPTABLE_VIEW;<br>    } <span class="hljs-keyword">else</span> {<br>        <span class="hljs-keyword">this</span>.logger.debug(<span class="hljs-string">"View remains unresolved"</span> + mediaTypeInfo);<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>

<p>我们继续点进去看，他是怎么获得候选的视图的呢？</p>
<p>getCandidateViews中看到他是把所有的视图解析器拿来，进行while循环，挨个解析！</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">private</span> List&lt;View&gt; <span class="hljs-title">getCandidateViews</span><span class="hljs-params">(String viewName, Locale locale, List&lt;MediaType&gt; requestedMediaTypes)</span> <span class="hljs-keyword">throws</span> Exception </span>{<br>    List&lt;View&gt; candidateViews = <span class="hljs-keyword">new</span> ArrayList();<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.viewResolvers != <span class="hljs-keyword">null</span>) {<br>        Assert.state(<span class="hljs-keyword">this</span>.contentNegotiationManager != <span class="hljs-keyword">null</span>, <span class="hljs-string">"No ContentNegotiationManager set"</span>);<br>        <span class="hljs-comment">//遍历所有的视图解析器</span><br>        Iterator var5 = <span class="hljs-keyword">this</span>.viewResolvers.iterator();<br><br>        <span class="hljs-keyword">while</span>(var5.hasNext()) {<br>            ViewResolver viewResolver = (ViewResolver)var5.next();<br>            View view = viewResolver.resolveViewName(viewName, locale);<br>            <span class="hljs-keyword">if</span> (view != <span class="hljs-keyword">null</span>) {<br>                candidateViews.add(view);<br>            }<br>        }<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>



<p>所以得出结论：<strong>ContentNegotiatingViewResolver 这个视图解析器就是用来组合所有的视图解析器的</strong></p>
<p>我们再去研究下他的组合逻辑，看到有个属性viewResolvers，看看它是在哪里进行赋值的！</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">initServletContext</span><span class="hljs-params">(ServletContext servletContext)</span> </span>{<br>    Collection&lt;ViewResolver&gt; matchingBeans = BeanFactoryUtils.beansOfTypeIncludingAncestors(<span class="hljs-keyword">this</span>.obtainApplicationContext(), ViewResolver.class).values();<br>    ViewResolver viewResolver;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.viewResolvers == <span class="hljs-keyword">null</span>) {<br>        <span class="hljs-comment">//这里它是从beanFactory工具中获取容器中的所有视图解析器</span><br>        <span class="hljs-comment">//ViewRescolver.class 把所有的视图解析器来组合的</span><br>        <span class="hljs-keyword">this</span>.viewResolvers = <span class="hljs-keyword">new</span> ArrayList(matchingBeans.size());<br>        Iterator var3 = matchingBeans.iterator();<br><br>        <span class="hljs-keyword">while</span>(var3.hasNext()) {<br>            viewResolver = (ViewResolver)var3.next();<br>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span> != viewResolver) {<br>                <span class="hljs-keyword">this</span>.viewResolvers.add(viewResolver);<br>            }<br>        }<br>    } <span class="hljs-keyword">else</span> {<br>        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-keyword">this</span>.viewResolvers.size(); ++i) {<br>            viewResolver = (ViewResolver)<span class="hljs-keyword">this</span>.viewResolvers.get(i);<br>            <span class="hljs-keyword">if</span> (!matchingBeans.contains(viewResolver)) {<br>                String name = viewResolver.getClass().getName() + i;<br>                <span class="hljs-keyword">this</span>.obtainApplicationContext().getAutowireCapableBeanFactory().initializeBean(viewResolver, name);<br>            }<br>        }<br>    }<br><br>    AnnotationAwareOrderComparator.sort(<span class="hljs-keyword">this</span>.viewResolvers);<br>    <span class="hljs-keyword">this</span>.cnmFactoryBean.setServletContext(servletContext);<br>}<br></code></pre></td></tr></tbody></table></figure>



<p>既然它是在容器中去找视图解析器，我们是否可以猜想，我们就可以去实现一个视图解析器了呢？</p>
<p>我们可以自己给容器中去添加一个视图解析器；这个类就会帮我们自动的将它组合进来；<strong>我们去实现一下</strong></p>
<ol>
<li>我们在我们的主程序中去写一个视图解析器来试试；<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.cutiebambi.config;<br><br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.View;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.ViewResolver;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;<br><br><span class="hljs-keyword">import</span> java.util.Locale;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyMvcConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">WebMvcConfigurer</span> </span>{<br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ViewResolver <span class="hljs-title">MyViewResolver</span><span class="hljs-params">()</span></span>{<br>        <span class="hljs-keyword">return</span> MyViewResolver();<br>    }<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyViewResolver</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ViewResolver</span> </span>{<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-function"><span class="hljs-keyword">public</span> View <span class="hljs-title">resolveViewName</span><span class="hljs-params">(String viewName, Locale locale)</span> <span class="hljs-keyword">throws</span> Exception </span>{<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>        }<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>



</li>
</ol>
<ol start="2">
<li><p>怎么看我们自己写的视图解析器有没有起作用呢？<br>我们给 DispatcherServlet 中的 doDispatch方法 加个断点进行调试一下，因为所有的请求都会走到这个方法中。<br><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071832103.png" srcset="/img/loading.gif" lazyload></p>
</li>
<li><p>我们启动我们的项目，然后随便访问一个页面，看一下Debug信息；</p>
<p>刚开始这样写之后，我本地debug还没进到doDispatch的断点，项目就报错了。</p>
<figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'MyViewResolver' defined in class path resource [com/cutiebambi/config/MyMvcConfig.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.web.servlet.ViewResolver]: Factory method 'MyViewResolver' threw exception; nested exception is java.lang.StackOverflowError<br></code></pre></td></tr></tbody></table></figure>

<p>后来经过琢磨，把MyMvcConfig改成下面这样之后，程序就可以正常启动了。</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//如果你想diy一些定制化的功能，只要写这个组件，然后将它交给springboot, springboot就会帮我们自动装配。</span><br><span class="hljs-comment">//这个注解表明这是扩展的SpringMVC</span><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyMvcConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">WebMvcConfigurer</span> </span>{<br>    <span class="hljs-comment">//ViewResolver 实现了视图解析器接口的类，我们就可以把它看作是视图解析器</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> ViewResolver <span class="hljs-title">MyViewResolver</span><span class="hljs-params">()</span></span>{<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> MyViewResolver();<br>    }<br>}<br><br><span class="hljs-comment">//自定义一个自己的视图解析器，MyViewResolver</span><br><span class="hljs-comment">//把这个从上面挪下来</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyViewResolver</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ViewResolver</span> </span>{<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> View <span class="hljs-title">resolveViewName</span><span class="hljs-params">(String viewName, Locale locale)</span> <span class="hljs-keyword">throws</span> Exception </span>{<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>


</li>
</ol>
<p>   找到this</p>
<p>   <img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071910057.png" srcset="/img/loading.gif" lazyload></p>
<p>   找到视图解析器viewResolvers，我们看到我们自己定义的视图解析器也在这里了^-^</p>
<p>   <img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071910474.png" srcset="/img/loading.gif" lazyload></p>
<p>   所以说，我们如果想要使用自己定制化的东西，我们只需要给容器中添加这个组件就好了！剩下的事情SpringBoot就会帮我们做了！</p>
<h3 id="转换器和格式化器"><a href="#转换器和格式化器" class="headerlink" title="转换器和格式化器"></a>转换器和格式化器</h3><ul>
<li><p>在WebMvcAutoConfiguration.java中找到格式化转换器：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> FormattingConversionService <span class="hljs-title">mvcConversionService</span><span class="hljs-params">()</span> </span>{<br>    WebMvcProperties.Format format = <span class="hljs-keyword">this</span>.mvcProperties.getFormat();<br>    <span class="hljs-comment">//拿到配置文件中的格式化规则</span><br>    WebConversionService conversionService = <span class="hljs-keyword">new</span> WebConversionService((<span class="hljs-keyword">new</span> DateTimeFormatters()).dateFormat(format.getDate()).timeFormat(format.getTime()).dateTimeFormat(format.getDateTime()));<br>    <span class="hljs-keyword">this</span>.addFormatters(conversionService);<br>    <span class="hljs-keyword">return</span> conversionService;<br>}<br></code></pre></td></tr></tbody></table></figure>
</li>
<li><p>点进去：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> DateTimeFormatters <span class="hljs-title">dateFormat</span><span class="hljs-params">(String pattern)</span> </span>{<br>    <span class="hljs-keyword">if</span> (isIso(pattern)) {<br>        <span class="hljs-keyword">this</span>.dateFormatter = DateTimeFormatter.ISO_LOCAL_DATE;<br>        <span class="hljs-keyword">this</span>.datePattern = <span class="hljs-string">"yyyy-MM-dd"</span>;<br>    } <span class="hljs-keyword">else</span> {<br>        <span class="hljs-keyword">this</span>.dateFormatter = formatter(pattern);<br>        <span class="hljs-keyword">this</span>.datePattern = pattern;<br>    }<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;<br>}<br></code></pre></td></tr></tbody></table></figure>



</li>
</ul>
<ul>
<li>可以看到在我们的Properties文件中，我们可以进行自动配置它！</li>
<li>如果配置了自己的格式化方式，就会注册到Bean中生效，我们可以在配置文件中配置日期格式化的规则：</li>
</ul>
<h3 id="修改SpringBoot的默认配置"><a href="#修改SpringBoot的默认配置" class="headerlink" title="修改SpringBoot的默认配置"></a>修改SpringBoot的默认配置</h3><h4 id="方式一："><a href="#方式一：" class="headerlink" title="方式一："></a>方式一：</h4><p>这么多的自动配置，原理都是一样的，通过这个WebMVC的自动配置原理分析，我们要学会一种学习方式，通过源码探究，得出结论；这个结论一定是属于自己的，而且一通百通。</p>
<p>SpringBoot的底层，大量用到了这些设计细节思想，所以，没事需要多阅读源码！得出结论；</p>
<p>SpringBoot在自动配置很多组件的时候，先看容器中有没有用户自己配置的（如果用户自己配置@bean），如果有就用用户配置的，如果没有就用自动配置的；</p>
<p>如果有些组件可以存在多个，比如我们的视图解析器，就将用户配置的和自己默认的组合起来！</p>
<h4 id="方式二：扩展使用Spring-MVC"><a href="#方式二：扩展使用Spring-MVC" class="headerlink" title="方式二：扩展使用Spring MVC"></a>方式二：扩展使用Spring MVC</h4><p>官方文档如下：</p>
<p>If you want to keep Spring Boot MVC features and you want to add additional MVC configuration (interceptors, formatters, view controllers, and other features), you can add your own @Configuration class of type WebMvcConfigurer but without @EnableWebMvc. If you wish to provide custom instances of RequestMappingHandlerMapping, RequestMappingHandlerAdapter, or ExceptionHandlerExceptionResolver, you can declare a WebMvcRegistrationsAdapter instance to provide such components.</p>
<p>我们要做的就是编写一个@Configuration注解类，并且类型要为WebMvcConfigurer，还不能标注@EnableWebMvc注解；我们去自己写一个；我们新建一个包叫config，写一个类MyMvcConfig；</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.cutiebambi.config;<br><br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.View;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.ViewResolver;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.ViewControllerRegistry;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;<br><br><span class="hljs-keyword">import</span> java.util.Locale;<br><br><span class="hljs-comment">//如果你想diy一些定制化的功能，只要写这个组件，然后将它交给springboot, springboot就会帮我们自动装配。</span><br><span class="hljs-comment">//扩展spring mvc</span><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyMvcConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">WebMvcConfigurer</span> </span>{<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addViewControllers</span><span class="hljs-params">(ViewControllerRegistry registry)</span> </span>{<br>        <span class="hljs-comment">//只需要访问 http://localhost:8080/bambi  就可以跳转到index.html</span><br>        registry.addViewController(<span class="hljs-string">"/bambi"</span>).setViewName(<span class="hljs-string">"index"</span>);<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>



<ul>
<li>我们去浏览器访问一下：</li>
</ul>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071941989.png" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>经过验证，<strong>确实跳转过来了！所以说，我们要扩展SpringMVC，官方推荐我们这么去使用，既保留了SpringBoot所有的自动配置，也能用我们扩展的配置！</strong></li>
</ul>
<h4 id="分析原理："><a href="#分析原理：" class="headerlink" title="分析原理："></a>分析原理：</h4><p>1、WebMvcAutoConfiguration 是 SpringMVC的自动配置类，里面有一个类WebMvcAutoConfigurationAdapter</p>
<p>2、这个类上有一个注解，在做其他自动配置时会导入：@Import(EnableWebMvcConfiguration.class)</p>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071946923.png" srcset="/img/loading.gif" lazyload></p>
<p>3、我们点进EnableWebMvcConfiguration这个类看一下，它继承了一个父类：DelegatingWebMvcConfiguration</p>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210071947922.png" srcset="/img/loading.gif" lazyload></p>
<p>这个父类中有这样一段代码：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DelegatingWebMvcConfiguration</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">WebMvcConfigurationSupport</span> </span>{<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> WebMvcConfigurerComposite configurers = <span class="hljs-keyword">new</span> WebMvcConfigurerComposite();<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">DelegatingWebMvcConfiguration</span><span class="hljs-params">()</span> </span>{<br>    }<br><br>    <span class="hljs-meta">@Autowired(</span><br><span class="hljs-meta">        required = false</span><br><span class="hljs-meta">    )</span><br>    <span class="hljs-comment">//从容器中获取所有的Webmvc Configurer</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setConfigurers</span><span class="hljs-params">(List&lt;WebMvcConfigurer&gt; configurers)</span> </span>{<br>        <span class="hljs-keyword">if</span> (!CollectionUtils.isEmpty(configurers)) {<br>            <span class="hljs-keyword">this</span>.configurers.addWebMvcConfigurers(configurers);<br>        }<br><br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>



<p>4、我们可以在这个类中去寻找一个我们刚才设置的viewController当做参考，发现它调用了一个</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addViewControllers</span><span class="hljs-params">(ViewControllerRegistry registry)</span> </span>{<br>    <span class="hljs-keyword">this</span>.configurers.addViewControllers(registry);<br>}<br></code></pre></td></tr></tbody></table></figure>



<p>5、我们点进去看一下</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addViewControllers</span><span class="hljs-params">(ViewControllerRegistry registry)</span> </span>{<br>    Iterator var2 = <span class="hljs-keyword">this</span>.delegates.iterator();<br><br>    <span class="hljs-keyword">while</span>(var2.hasNext()) {<br>        <span class="hljs-comment">//将所有的WebMvcConfigurer相关配置来一起调用！包括我们自己配置的和Spring给我们配置的</span><br>        WebMvcConfigurer delegate = (WebMvcConfigurer)var2.next();<br>        delegate.addViewControllers(registry);<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>

<p>所以得出结论：所有的WebMvcConfiguration都会被作用，不止Spring自己的配置类，我们自己的配置类当然也会被调用；</p>
<h3 id="全面接管SpringMVC"><a href="#全面接管SpringMVC" class="headerlink" title="全面接管SpringMVC"></a>全面接管SpringMVC</h3><h4 id="测试加上-EnableWebMvc之后会发生什么？"><a href="#测试加上-EnableWebMvc之后会发生什么？" class="headerlink" title="测试加上@EnableWebMvc之后会发生什么？"></a>测试加上@EnableWebMvc之后会发生什么？</h4><ul>
<li><p>官方文档：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//如果你想完全控制Spring MVC，你可以添加你自己的@Configuration，带有@EnableWebMvc注解，或者添加你自己的@Configuration注解的DelegatingWebMvcConfiguration，就像@EnableWebMvc的Javadoc中描述的那样。</span><br>If you want to take complete control of Spring MVC, you can add your own <span class="hljs-meta">@Configuration</span> annotated with <span class="hljs-meta">@EnableWebMvc</span>, or alternatively add your own <span class="hljs-meta">@Configuration</span>-annotated DelegatingWebMvcConfiguration as described in the Javadoc of <span class="hljs-meta">@EnableWebMvc</span>.<br></code></pre></td></tr></tbody></table></figure>



</li>
</ul>
<ul>
<li><p>全面接管即：SpringBoot对SpringMVC的自动配置不需要了，所有都是我们自己去配置！</p>
</li>
<li><p>只需在我们的配置类中要加一个@EnableWebMvc。</p>
</li>
<li><p>我们看下如果我们全面接管了SpringMVC了，我们之前SpringBoot给我们配置的静态资源映射会不会无效，我们可以去测试一下；</p>
</li>
<li><p>不加注解之前，访问静态资源：</p>
<p>在工程static下添加一个静态资源</p>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210081125289.png" srcset="/img/loading.gif" lazyload></p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"Content-Type"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"text/html;charset=utf-8"</span>/&gt;</span><span class="hljs-comment">&lt;!-- 不加这行代码，文本中的汉字会乱码 --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>hello bambi,我是静态资源~<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span><br></code></pre></td></tr></tbody></table></figure>



</li>
</ul>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210081120596.png" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>给配置类加上注解：@EnableWebMvc</li>
</ul>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210081121773.png" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>我们发现所有的SpringMVC自动配置都失效了！访问不到静态资源了；</li>
<li><strong>当然，我们开发中，不推荐使用全面接管SpringMVC</strong></li>
</ul>
<h4 id="思考：为什么加了一个注解，自动配置就失效了？"><a href="#思考：为什么加了一个注解，自动配置就失效了？" class="headerlink" title="思考：为什么加了一个注解，自动配置就失效了？"></a>思考：为什么加了一个注解，自动配置就失效了？</h4><ol>
<li><p>查看代码，加上@EnableWebMvc其实就是导入了一个类: DelegatingWebMvcConfiguration, DelegatingWebMvcConfiguration类的作用是从容器中获取所有的WebMvcConfigurer。</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Retention(RetentionPolicy.RUNTIME)</span><br><span class="hljs-meta">@Target({ElementType.TYPE})</span><br><span class="hljs-meta">@Documented</span><br><span class="hljs-meta">@Import({DelegatingWebMvcConfiguration.class})</span><br><span class="hljs-keyword">public</span> <span class="hljs-meta">@interface</span> EnableWebMvc {<br>}<br></code></pre></td></tr></tbody></table></figure>

<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration(</span><br><span class="hljs-meta">    proxyBeanMethods = false</span><br><span class="hljs-meta">)</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DelegatingWebMvcConfiguration</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">WebMvcConfigurationSupport</span> </span>{<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> WebMvcConfigurerComposite configurers = <span class="hljs-keyword">new</span> WebMvcConfigurerComposite();<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">DelegatingWebMvcConfiguration</span><span class="hljs-params">()</span> </span>{<br>    }<br><br>    <span class="hljs-meta">@Autowired(</span><br><span class="hljs-meta">        required = false</span><br><span class="hljs-meta">    )</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setConfigurers</span><span class="hljs-params">(List&lt;WebMvcConfigurer&gt; configurers)</span> </span>{<br>        <span class="hljs-keyword">if</span> (!CollectionUtils.isEmpty(configurers)) {<br>            <span class="hljs-keyword">this</span>.configurers.addWebMvcConfigurers(configurers);<br>        }<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>
</li>
<li><p>DelegatingWebMvcConfiguration继承了一个父类 WebMvcConfigurationSupport</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DelegatingWebMvcConfiguration</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">WebMvcConfigurationSupport</span></span><br></code></pre></td></tr></tbody></table></figure>



</li>
</ol>
<ol start="3">
<li>我们再来看一下Webmvc自动配置类 (WebMvcAutoConfiguration)的代码。只有当不存在WebMvcConfigurationSupport的时候才会生效，加了@EnableWebMvc之后就相当于是自动引入了WebMvcAutoConfiguration类，所以Spring Boot的自动配置类就会失效。</li>
</ol>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210081134780.png" srcset="/img/loading.gif" lazyload></p>
<p>总结：@EnableWebMvc将WebMvcConfigurationSupport组件导入进来了；而导入的WebMvcConfigurationSupport只是SpringMVC最基本的功能！这个WebMvcConfigurationSupport进来之后，就使WebMvcAutoConfiguration这个类不满足条件，导致自动配置类失效！<br><strong>在SpringBoot中会有非常多的扩展配置，只要看见了这个，我们就应该多留心注意~</strong></p>
<h2 id="一个简单的员工管理系统"><a href="#一个简单的员工管理系统" class="headerlink" title="一个简单的员工管理系统"></a>一个简单的员工管理系统</h2><h2 id="准备工作-1"><a href="#准备工作-1" class="headerlink" title="准备工作"></a>准备工作</h2><ul>
<li><p>导入lombok依赖</p>
<p>Lombok官网: <a target="_blank" rel="noopener" href="https://www.projectlombok.org/">https://www.projectlombok.org/</a></p>
<p>Lombok项目是一个Java库，它会自动插入编辑器和构建工具中，Lombok提供了一组有用的注释，用来消除Java类中的大量样板代码。仅五个字符(@Data)就可以替换数百行代码从而产生干净，简洁且易于维护的Java类。用在实体类中，用注解生成构造方法，get/set，等方法</p>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- lombok --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.projectlombok<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>lombok<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></tbody></table></figure>



</li>
</ul>
<ul>
<li><p>@Data：注解在类，生成setter/getter、equals、canEqual、hashCode、toString方法，如为final属性，则不会为该属性生成setter方法</p>
</li>
<li><p>模拟DB中的数据，编写部门和员工的实体类以及对应的Dao。</p>
<ul>
<li><p>部门表实体类</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.cutiebambi.pojo;<br><br><span class="hljs-keyword">import</span> lombok.AllArgsConstructor;<br><span class="hljs-keyword">import</span> lombok.Data;<br><span class="hljs-keyword">import</span> lombok.NoArgsConstructor;<br><br><span class="hljs-comment">//部门表</span><br><span class="hljs-meta">@Data</span><br><span class="hljs-meta">@AllArgsConstructor</span><br><span class="hljs-meta">@NoArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Department</span> </span>{<br>    <span class="hljs-keyword">private</span> Integer id;<br>    <span class="hljs-keyword">private</span> String departmentName;<br>}<br></code></pre></td></tr></tbody></table></figure>
</li>
<li><p>部门表Dao层</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.cutiebambi.dao;<br><br><span class="hljs-keyword">import</span> com.cutiebambi.pojo.Department;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Repository;<br><br><span class="hljs-keyword">import</span> java.util.Collection;<br><span class="hljs-keyword">import</span> java.util.HashMap;<br><span class="hljs-keyword">import</span> java.util.List;<br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-comment">//部门dao</span><br><span class="hljs-meta">@Repository</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DepartmentDao</span> </span>{<br>    <span class="hljs-comment">//模拟数据库中的数据</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Map&lt;Integer, Department&gt; departments = <span class="hljs-keyword">null</span>;<br>    <span class="hljs-keyword">static</span>{<br>        <span class="hljs-comment">//创建一个部门表</span><br>        departments = <span class="hljs-keyword">new</span> HashMap&lt;Integer, Department&gt;();<br><br>        departments.put(<span class="hljs-number">101</span>, <span class="hljs-keyword">new</span> Department(<span class="hljs-number">101</span>, <span class="hljs-string">"教学部"</span>));<br>        departments.put(<span class="hljs-number">102</span>, <span class="hljs-keyword">new</span> Department(<span class="hljs-number">102</span>, <span class="hljs-string">"市场部"</span>));<br>        departments.put(<span class="hljs-number">103</span>, <span class="hljs-keyword">new</span> Department(<span class="hljs-number">103</span>, <span class="hljs-string">"教研部"</span>));<br>        departments.put(<span class="hljs-number">104</span>, <span class="hljs-keyword">new</span> Department(<span class="hljs-number">104</span>, <span class="hljs-string">"运营部"</span>));<br>        departments.put(<span class="hljs-number">105</span>, <span class="hljs-keyword">new</span> Department(<span class="hljs-number">105</span>, <span class="hljs-string">"后勤部"</span>));<br>    }<br><br>    <span class="hljs-comment">//获取所有部门信息</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Collection&lt;Department&gt; <span class="hljs-title">getDepartments</span><span class="hljs-params">()</span></span>{<br>        <span class="hljs-keyword">return</span> departments.values();<br>    }<br><br>    <span class="hljs-comment">//根据id获取单个部门信息</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Department <span class="hljs-title">getDepartmentById</span><span class="hljs-params">(Integer id)</span></span>{<br>        <span class="hljs-keyword">return</span> departments.get(id);<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>



</li>
</ul>
</li>
</ul>
<ul>
<li>员工表实体类<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.cutiebambi.pojo;<br><br><span class="hljs-keyword">import</span> lombok.AllArgsConstructor;<br><span class="hljs-keyword">import</span> lombok.NoArgsConstructor;<br><br><span class="hljs-keyword">import</span> java.util.Date;<br><br><span class="hljs-comment">//员工表</span><br><span class="hljs-meta">@NoArgsConstructor</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Employee</span> </span>{<br>    <span class="hljs-keyword">private</span> Integer id;<br>    <span class="hljs-keyword">private</span> String lastName;<br>    <span class="hljs-keyword">private</span> String email;<br>    <span class="hljs-keyword">private</span> Integer gender; <span class="hljs-comment">//0:女 1:男</span><br><br>    <span class="hljs-keyword">private</span> Department department;<br>    <span class="hljs-keyword">private</span> Date birth;<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Employee</span><span class="hljs-params">(Integer id, String lastName, String email, Integer gender, Department department)</span> </span>{<br>        <span class="hljs-keyword">this</span>.id = id;<br>        <span class="hljs-keyword">this</span>.lastName = lastName;<br>        <span class="hljs-keyword">this</span>.email = email;<br>        <span class="hljs-keyword">this</span>.gender = gender;<br>        <span class="hljs-keyword">this</span>.department = department;<br>        <span class="hljs-keyword">this</span>.birth = <span class="hljs-keyword">new</span> Date();<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Integer <span class="hljs-title">getId</span><span class="hljs-params">()</span> </span>{<br>        <span class="hljs-keyword">return</span> id;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setId</span><span class="hljs-params">(Integer id)</span> </span>{<br>        <span class="hljs-keyword">this</span>.id = id;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getLastName</span><span class="hljs-params">()</span> </span>{<br>        <span class="hljs-keyword">return</span> lastName;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setLastName</span><span class="hljs-params">(String lastName)</span> </span>{<br>        <span class="hljs-keyword">this</span>.lastName = lastName;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getEmail</span><span class="hljs-params">()</span> </span>{<br>        <span class="hljs-keyword">return</span> email;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setEmail</span><span class="hljs-params">(String email)</span> </span>{<br>        <span class="hljs-keyword">this</span>.email = email;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Integer <span class="hljs-title">getGender</span><span class="hljs-params">()</span> </span>{<br>        <span class="hljs-keyword">return</span> gender;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setGender</span><span class="hljs-params">(Integer gender)</span> </span>{<br>        <span class="hljs-keyword">this</span>.gender = gender;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Department <span class="hljs-title">getDepartment</span><span class="hljs-params">()</span> </span>{<br>        <span class="hljs-keyword">return</span> department;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setDepartment</span><span class="hljs-params">(Department department)</span> </span>{<br>        <span class="hljs-keyword">this</span>.department = department;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Date <span class="hljs-title">getBirth</span><span class="hljs-params">()</span> </span>{<br>        <span class="hljs-keyword">return</span> birth;<br>    }<br><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setBirth</span><span class="hljs-params">(Date birth)</span> </span>{<br>        <span class="hljs-keyword">this</span>.birth = birth;<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>



</li>
</ul>
<ul>
<li>员工表Dao层<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.cutiebambi.dao;<br><br><span class="hljs-keyword">import</span> com.cutiebambi.pojo.Department;<br><span class="hljs-keyword">import</span> com.cutiebambi.pojo.Employee;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Repository;<br><span class="hljs-keyword">import</span> org.springframework.util.StringUtils;<br><br><span class="hljs-keyword">import</span> java.util.Collection;<br><span class="hljs-keyword">import</span> java.util.HashMap;<br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-comment">//员工dao</span><br><span class="hljs-meta">@Repository</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EmployeeDao</span> </span>{<br>    <span class="hljs-meta">@Autowired</span> <span class="hljs-comment">//Field injection is not recommended</span><br>    <span class="hljs-keyword">private</span> DepartmentDao departmentDao;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Integer id = <span class="hljs-number">1006</span>;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Map&lt;Integer, Employee&gt; employees = <span class="hljs-keyword">null</span>;<br><br>    <span class="hljs-comment">//模拟DB中的数据</span><br>    <span class="hljs-keyword">static</span>{<br>        <span class="hljs-comment">//创建一个员工表(自己写的时候，把这一行没写，直接用employees call put方法了。差点弄出来空指针异常了)</span><br>        employees = <span class="hljs-keyword">new</span> HashMap&lt;Integer, Employee&gt;();<br><br>        employees.put(<span class="hljs-number">1001</span>, <span class="hljs-keyword">new</span> Employee(<span class="hljs-number">1001</span>, <span class="hljs-string">"summer"</span>, <span class="hljs-string">"1@lucky.com"</span>, <span class="hljs-number">0</span>, <span class="hljs-keyword">new</span> Department(<span class="hljs-number">101</span>, <span class="hljs-string">"教学部"</span>)));<br>        employees.put(<span class="hljs-number">1002</span>, <span class="hljs-keyword">new</span> Employee(<span class="hljs-number">1002</span>, <span class="hljs-string">"jack"</span>, <span class="hljs-string">"2@lucky.com"</span>, <span class="hljs-number">1</span>, <span class="hljs-keyword">new</span> Department(<span class="hljs-number">101</span>, <span class="hljs-string">"市场部"</span>)));<br>        employees.put(<span class="hljs-number">1003</span>, <span class="hljs-keyword">new</span> Employee(<span class="hljs-number">1003</span>, <span class="hljs-string">"cecil"</span>, <span class="hljs-string">"3@lucky.com"</span>, <span class="hljs-number">1</span>, <span class="hljs-keyword">new</span> Department(<span class="hljs-number">101</span>, <span class="hljs-string">"教研部"</span>)));<br>        employees.put(<span class="hljs-number">1004</span>, <span class="hljs-keyword">new</span> Employee(<span class="hljs-number">1004</span>, <span class="hljs-string">"roy"</span>, <span class="hljs-string">"4@lucky.com"</span>, <span class="hljs-number">1</span>, <span class="hljs-keyword">new</span> Department(<span class="hljs-number">101</span>, <span class="hljs-string">"运营部"</span>)));<br>        employees.put(<span class="hljs-number">1005</span>, <span class="hljs-keyword">new</span> Employee(<span class="hljs-number">1005</span>, <span class="hljs-string">"cara"</span>, <span class="hljs-string">"5@lucky.com"</span>, <span class="hljs-number">0</span>, <span class="hljs-keyword">new</span> Department(<span class="hljs-number">101</span>, <span class="hljs-string">"后勤部"</span>)));<br>    }<br><br>    <span class="hljs-comment">//增加一个员工</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addEmployee</span><span class="hljs-params">(Employee employee)</span></span>{<br>        <span class="hljs-comment">//Integer id = 1006;//这行代码不能写在这里，要不每一次新增员工的时候，id都是从1006开始了！又是我犯的一个错误</span><br>        <span class="hljs-keyword">if</span>(employee.getId() == <span class="hljs-keyword">null</span>){<br>            employee.setId(id++);<br>        }<br>        employees.put(employee.getId(), employee);<br>    }<br><br>    <span class="hljs-comment">//查询全部员工</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Collection&lt;Employee&gt; <span class="hljs-title">getEmployees</span><span class="hljs-params">()</span></span>{<br>        <span class="hljs-keyword">return</span> employees.values();<br>    }<br><br>    <span class="hljs-comment">//根据id查询员工</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Employee <span class="hljs-title">getEmployeeById</span><span class="hljs-params">(Integer id)</span></span>{<br>        <span class="hljs-keyword">return</span> employees.get(id);<br>    }<br><br>    <span class="hljs-comment">//删除员工</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">removeEmployeeById</span><span class="hljs-params">(Integer id)</span></span>{<br>        employees.remove(id);<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>



</li>
</ul>
<h2 id=""><a href="#" class="headerlink" title=""></a></h2><h2 id="首页实现"><a href="#首页实现" class="headerlink" title="首页实现"></a>首页实现</h2><ul>
<li><p>实现通过localhost:8080或者localhost:8080/index进入首页的功能</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyMvcConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">WebMvcConfigurer</span> </span>{<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addViewControllers</span><span class="hljs-params">(ViewControllerRegistry registry)</span> </span>{<br>        <span class="hljs-comment">//只需要访问http://localhost:8080/或者http://localhost:8080/index就可以跳转到index.html页面</span><br>        registry.addViewController(<span class="hljs-string">"/"</span>).setViewName(<span class="hljs-string">"index"</span>);<br>        registry.addViewController(<span class="hljs-string">"/index"</span>).setViewName(<span class="hljs-string">"index"</span>);<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>



</li>
</ul>
<ul>
<li><p>所有的静态资源导入都需要使用Thymeleaf接管。所以：</p>
<ol>
<li>要先给静态资源导入Thymeleaf命名空间。<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span> <span class="hljs-attr">xmlns:th</span>=<span class="hljs-string">"http://www.thymeleaf.org"</span>&gt;</span><br></code></pre></td></tr></tbody></table></figure>



</li>
</ol>
</li>
</ul>
<ol start="2">
<li><p>按照Thymeleaf的语法规则，修改静态资源文件。</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-comment">&lt;!-- Bootstrap core CSS --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">"@{/css/bootstrap.min.css}"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>&gt;</span><br><span class="hljs-comment">&lt;!-- Custom styles for this template --&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">"@{/css/signin.css}"</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span>&gt;</span><br><br><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mb-4"</span> <span class="hljs-attr">th:src</span>=<span class="hljs-string">"@{/img/bootstrap-solid.svg}"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">""</span> <span class="hljs-attr">width</span>=<span class="hljs-string">"72"</span> <span class="hljs-attr">height</span>=<span class="hljs-string">"72"</span>&gt;</span><br></code></pre></td></tr></tbody></table></figure>
</li>
<li><p><strong>修改这里的时候有遇到下面这个问题。</strong>之前中英文我写的href是@{/index.html}，但是点击中文或者English的超链接的时候一直报错，导致国际化一直跳转失败。后来把href改为@{/index}问题才得以解决。</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-lg btn-primary btn-block"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>&gt;</span> [[#{login.signIn}]] <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mt-5 mb-3 text-muted"</span>&gt;</span>© 2022-2023<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-sm"</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">"@{/index(l='zh_CN')}"</span>&gt;</span>中文<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-sm"</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">"@{/index(l='en_US')}"</span>&gt;</span>English<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-comment">&lt;!-- 之前这样写的，点击之后总是跳转到error页面</span><br><span class="hljs-comment">&lt;a class="btn btn-sm" th:href="@{/index.html(l='zh_CN')}"&gt;中文&lt;/a&gt;</span><br><span class="hljs-comment">&lt;a class="btn btn-sm" th:href="@{/index.html(l='en_US')}"&gt;English&lt;/a&gt;</span><br><span class="hljs-comment">--&gt;</span><br></code></pre></td></tr></tbody></table></figure>

<p>后来经过思考，发现如果改一下自定义Config，就可以通过href访问到/index.html页面了。<strong>但是至于为什么这个可以，我还不知道底层原理，后面知道了之后再补充到这里</strong></p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyMvcConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">WebMvcConfigurer</span> </span>{<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addViewControllers</span><span class="hljs-params">(ViewControllerRegistry registry)</span> </span>{<br>        registry.addViewController(<span class="hljs-string">"/"</span>).setViewName(<span class="hljs-string">"index"</span>);<br>        registry.addViewController(<span class="hljs-string">"/index"</span>).setViewName(<span class="hljs-string">"index"</span>);<br>        <span class="hljs-comment">//加上这行代码，上面的html就可以写成th:href="@{/index.html(l='en_US')}然后也能正常跳转了。</span><br>        registry.addViewController(<span class="hljs-string">"/index.html"</span>).setViewName(<span class="hljs-string">"index"</span>);<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>



</li>
</ol>
<pre><code class="hljs"> ![](https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210090836775.png)

 ![](https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210090836715.png)</code></pre>
<ul>
<li>关闭模板引擎的缓存<figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">thymeleaf:</span><br>    <span class="hljs-attr">cache:</span> <span class="hljs-literal">false</span><br></code></pre></td></tr></tbody></table></figure>

</li>
</ul>
<h2 id="页面国际化"><a href="#页面国际化" class="headerlink" title="页面国际化"></a>页面国际化</h2><h3 id="准备工作-2"><a href="#准备工作-2" class="headerlink" title="准备工作"></a>准备工作</h3><ul>
<li><p>先在IDEA中统一设置properties的编码问题！</p>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210090952395.png" srcset="/img/loading.gif" lazyload></p>
</li>
</ul>
<h3 id="配置文件编写"><a href="#配置文件编写" class="headerlink" title="配置文件编写"></a>配置文件编写</h3><ul>
<li><p>我们在resources资源文件下新建一个i18n目录，存放国际化配置文件</p>
<ul>
<li><p>建立一个login.properties文件，还有一个login_zh_CN.properties；发现IDEA自动识别了我们要做国际化操作；文件夹变了！<br><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210090956477.png" srcset="/img/loading.gif" lazyload></p>
<p>接着可以直接在Resource Bundle上右键，添加en_US国际化配置文件</p>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210090956942.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210090957717.png" srcset="/img/loading.gif" lazyload></p>
<p><strong>接下来，我们就来编写国际化配置文件，我们可以看到idea下面有另外一个视图；</strong></p>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091001018.png" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>如果你的IDEA没有这个视图，那么去plugins里面下载如下插件，下载完之后页面就会显示Resource Bundle视图。<br><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091000847.png" srcset="/img/loading.gif" lazyload></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="配置文件生效探究"><a href="#配置文件生效探究" class="headerlink" title="配置文件生效探究"></a>配置文件生效探究</h3><ul>
<li><p>我们去看一下SpringBoot对国际化的自动配置！这里又涉及到一个类：MessageSourceAutoConfiguration</p>
</li>
<li><p>里面有一个方法，这里发现SpringBoot已经自动配置好了管理我们国际化资源文件(就是在i8n文件夹下的文件)的组件 ResourceBundleMessageSource； （这个东西是识别国际化配置信息文件里的信息）</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> MessageSource <span class="hljs-title">messageSource</span><span class="hljs-params">(MessageSourceProperties properties)</span> </span>{<br>    ResourceBundleMessageSource messageSource = <span class="hljs-keyword">new</span> ResourceBundleMessageSource();<br>    <span class="hljs-comment">//如果你配置了basename，那么就会用你配置的basename路径</span><br>    <span class="hljs-keyword">if</span> (StringUtils.hasText(properties.getBasename())) {<br>        messageSource.setBasenames(StringUtils.commaDelimitedListToStringArray(StringUtils.trimAllWhitespace(properties.getBasename())));<br>    }<br><br>    <span class="hljs-keyword">if</span> (properties.getEncoding() != <span class="hljs-keyword">null</span>) {<br>        messageSource.setDefaultEncoding(properties.getEncoding().name());<br>    }<br><br>    messageSource.setFallbackToSystemLocale(properties.isFallbackToSystemLocale());<br>    Duration cacheDuration = properties.getCacheDuration();<br>    <span class="hljs-keyword">if</span> (cacheDuration != <span class="hljs-keyword">null</span>) {<br>        messageSource.setCacheMillis(cacheDuration.toMillis());<br>    }<br><br>    messageSource.setAlwaysUseMessageFormat(properties.isAlwaysUseMessageFormat());<br>    messageSource.setUseCodeAsDefaultMessage(properties.isUseCodeAsDefaultMessage());<br>    <span class="hljs-keyword">return</span> messageSource;<br>}<br></code></pre></td></tr></tbody></table></figure>

<ul>
<li>我们项目的国际化文件在i18n下面，所以配置我们的basename为i18n.login<figure class="highlight yaml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">spring:</span><br>  <span class="hljs-attr">thymeleaf:</span><br>    <span class="hljs-attr">cache:</span> <span class="hljs-literal">false</span><br>  <span class="hljs-attr">messages:</span><br>    <span class="hljs-attr">basename:</span> <span class="hljs-string">i18n.login</span><br></code></pre></td></tr></tbody></table></figure>



</li>
</ul>
</li>
</ul>
<p>  <img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091009498.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="配置页面国际化值"><a href="#配置页面国际化值" class="headerlink" title="配置页面国际化值"></a>配置页面国际化值</h3><ul>
<li>去页面获取国际化的值，查看Thymeleaf的文档，找到message取值操作为：#{…}。<br><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091014916.png" srcset="/img/loading.gif" lazyload></li>
</ul>
<h3 id="配置国际化解析"><a href="#配置国际化解析" class="headerlink" title="配置国际化解析"></a>配置国际化解析</h3><ul>
<li><p>在Spring中有一个国际化的Locale （区域信息对象）；里面有一个叫做LocaleResolver （获取区域信息对象）的解析器！</p>
</li>
<li><p>我们去我们webmvc（WebMvcAutoConfiguration.java）自动配置文件，寻找一下！看到SpringBoot默认配置：</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-meta">@Bean</span><br><span class="hljs-meta">@ConditionalOnMissingBean(</span><br><span class="hljs-meta">    name = {"localeResolver"} //不存在localeResolver的时候，走这个bean设置默认Locale</span><br><span class="hljs-meta">)</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> LocaleResolver <span class="hljs-title">localeResolver</span><span class="hljs-params">()</span> </span>{<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.webProperties.getLocaleResolver() == org.springframework.boot.autoconfigure.web.WebProperties.LocaleResolver.FIXED) {<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> FixedLocaleResolver(<span class="hljs-keyword">this</span>.webProperties.getLocale());<br>    } <span class="hljs-keyword">else</span> {<br>        <span class="hljs-comment">//接收端国际化分解</span><br>        AcceptHeaderLocaleResolver localeResolver = <span class="hljs-keyword">new</span> AcceptHeaderLocaleResolver();<br>        localeResolver.setDefaultLocale(<span class="hljs-keyword">this</span>.webProperties.getLocale());<br>        <span class="hljs-keyword">return</span> localeResolver;<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>
</li>
<li><p>点进去AcceptHeaderLocaleResolver（这是源码给的一个国际化（地区）解析器，我们也可以参考这个写一个自己的国际化解析器）</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-function"><span class="hljs-keyword">public</span> Locale <span class="hljs-title">resolveLocale</span><span class="hljs-params">(HttpServletRequest request)</span> </span>{<br>    Locale defaultLocale = <span class="hljs-keyword">this</span>.getDefaultLocale();<br>    <span class="hljs-keyword">if</span> (defaultLocale != <span class="hljs-keyword">null</span> &amp;&amp; request.getHeader(<span class="hljs-string">"Accept-Language"</span>) == <span class="hljs-keyword">null</span>) {<br>        <span class="hljs-keyword">return</span> defaultLocale;<br>    } <span class="hljs-keyword">else</span> {<br>        Locale requestLocale = request.getLocale();<br>        List&lt;Locale&gt; supportedLocales = <span class="hljs-keyword">this</span>.getSupportedLocales();<br>        <span class="hljs-keyword">if</span> (!supportedLocales.isEmpty() &amp;&amp; !supportedLocales.contains(requestLocale)) {<br>            Locale supportedLocale = <span class="hljs-keyword">this</span>.findSupportedLocale(request, supportedLocales);<br>            <span class="hljs-keyword">if</span> (supportedLocale != <span class="hljs-keyword">null</span>) {<br>                <span class="hljs-keyword">return</span> supportedLocale;<br>            } <span class="hljs-keyword">else</span> {<br>                <span class="hljs-keyword">return</span> defaultLocale != <span class="hljs-keyword">null</span> ? defaultLocale : requestLocale;<br>            }<br>        } <span class="hljs-keyword">else</span> {<br>            <span class="hljs-keyword">return</span> requestLocale;<br>        }<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>

<ul>
<li><p>自己的国际化解析器</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.cutiebambi.config;<br><br><span class="hljs-keyword">import</span> org.springframework.util.StringUtils;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.LocaleResolver;<br><br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><span class="hljs-keyword">import</span> java.util.Locale;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyLocaleResolver</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">LocaleResolver</span> </span>{<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> Locale <span class="hljs-title">resolveLocale</span><span class="hljs-params">(HttpServletRequest request)</span> </span>{<br>        String language = request.getParameter(<span class="hljs-string">"lang"</span>);<br><br>        Locale requestLocale = Locale.getDefault();<br>        <span class="hljs-keyword">if</span>(!StringUtils.isEmpty(language)){<br>            String[] s = StringUtils.split(language, <span class="hljs-string">"_"</span>);<br>            requestLocale = <span class="hljs-keyword">new</span> Locale(s[<span class="hljs-number">0</span>], s[<span class="hljs-number">1</span>]);<br>        }<br>        <span class="hljs-keyword">return</span> requestLocale;<br>    }<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setLocale</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Locale locale)</span> </span>{<br><br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>



</li>
</ul>
</li>
</ul>
<ul>
<li>请求端携带上lang参数<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-sm"</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">"@{/index(lang='zh_CN')}"</span>&gt;</span>中文<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-sm"</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">"@{/index(lang='en_US')}"</span>&gt;</span>English<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br></code></pre></td></tr></tbody></table></figure>



</li>
</ul>
<ul>
<li><p>将自己写的国际化解析器放进Spring Boot里面</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//这样做之后，自己写的国际化组件就生效了</span><br><span class="hljs-meta">@Bean</span><span class="hljs-comment">//注入自己写的国际化组件</span><br><span class="hljs-function"><span class="hljs-keyword">public</span> LocaleResolver <span class="hljs-title">localeResolver</span><span class="hljs-params">()</span></span>{<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> MyLocaleResolver();<br>}<br></code></pre></td></tr></tbody></table></figure>
</li>
<li><p>测试自己的代码</p>
<p>点击英文</p>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091027975.png" srcset="/img/loading.gif" lazyload></p>
<p>点击中文</p>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091028653.png" srcset="/img/loading.gif" lazyload></p>
</li>
</ul>
<h3 id="总结-2"><a href="#总结-2" class="headerlink" title="总结"></a>总结</h3><p>页面国家化步骤：</p>
<ul>
<li>我们需要配置i18n文件，并在application.properties配置文件中绑定，之后在对应的html中用thymeleaf获取（获取国家化信息使用#{} ，链接url是@{} ，变量${}）<ul>
<li>Thymeleaf 官网：<a target="_blank" rel="noopener" href="https://www.thymeleaf.org/">https://www.thymeleaf.org/</a> </li>
</ul>
</li>
<li>如果我们需要在项目中进行按钮自动切换，我们需要自己定义一个组件MyLocalResolver继承LocaleResolver</li>
<li>记得将自己写的组件配置到spring容器中，@Bean</li>
</ul>
<h2 id="登录功能与拦截器"><a href="#登录功能与拦截器" class="headerlink" title="登录功能与拦截器"></a>登录功能与拦截器</h2><h3 id="登录功能实现"><a href="#登录功能实现" class="headerlink" title="登录功能实现"></a>登录功能实现</h3><ul>
<li><p>LoginController</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.cutiebambi.controller;<br><br><span class="hljs-keyword">import</span> org.springframework.stereotype.Controller;<br><span class="hljs-keyword">import</span> org.springframework.ui.Model;<br><span class="hljs-keyword">import</span> org.springframework.util.StringUtils;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestParam;<br><br><span class="hljs-keyword">import</span> javax.servlet.http.HttpSession;<br><br><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoginController</span> </span>{<br>    <span class="hljs-meta">@RequestMapping("/user/login")</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">login</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam(name = "userName")</span> String userName, <span class="hljs-meta">@RequestParam(name = "password")</span> String password, Model model, HttpSession session)</span></span>{<br>        <span class="hljs-keyword">if</span>(!StringUtils.isEmpty(userName) &amp;&amp; password.equals(<span class="hljs-string">"1"</span>)){<br>            session.setAttribute(<span class="hljs-string">"loginUser"</span>, userName);<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">"redirect:/main.html"</span>; <span class="hljs-comment">//重定向</span><br>        }<span class="hljs-keyword">else</span>{<br>            model.addAttribute(<span class="hljs-string">"msg"</span>, <span class="hljs-string">"用户名或密码错误，登录失败"</span>);<br>            <span class="hljs-keyword">return</span> <span class="hljs-string">"index"</span>;<br>        }<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>
</li>
<li><p>MyMvcConfig</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.cutiebambi.config;<br><br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.LocaleResolver;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.ViewControllerRegistry;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyMvcConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">WebMvcConfigurer</span> </span>{<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addViewControllers</span><span class="hljs-params">(ViewControllerRegistry registry)</span> </span>{<br>        <span class="hljs-comment">//只需要访问http://localhost:8080/或者http://localhost:8080/index就可以跳转到index.html页面</span><br>        registry.addViewController(<span class="hljs-string">"/"</span>).setViewName(<span class="hljs-string">"index"</span>);<br>        registry.addViewController(<span class="hljs-string">"/index"</span>).setViewName(<span class="hljs-string">"index"</span>);<br>        registry.addViewController(<span class="hljs-string">"/index.html"</span>).setViewName(<span class="hljs-string">"index"</span>);<br>        registry.addViewController(<span class="hljs-string">"/main.html"</span>).setViewName(<span class="hljs-string">"dashboard"</span>);<br>    }<br><br>    <span class="hljs-comment">//将自定义的国际化组件放进Spring Boot里。</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> LocaleResolver <span class="hljs-title">localeResolver</span><span class="hljs-params">()</span></span>{<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> MyLocaleResolver();<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>
</li>
<li><p>index.html</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">body</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"text-center"</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 修改form表单action --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">form</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"form-signin"</span> <span class="hljs-attr">th:action</span>=<span class="hljs-string">"@{/user/login}"</span>&gt;</span><br>        ...<br>        <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-lg btn-primary btn-block"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"submit"</span>&gt;</span> [[#{login.signIn}]] <span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"mt-5 mb-3 text-muted"</span>&gt;</span>© 2022-2023<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-sm"</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">"@{/index(lang='zh_CN')}"</span>&gt;</span>中文<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-sm"</span> <span class="hljs-attr">th:href</span>=<span class="hljs-string">"@{/index(lang='en_US')}"</span>&gt;</span>English<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">form</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span><br></code></pre></td></tr></tbody></table></figure>
</li>
<li><p>将登录之后的左上角名字显示为登录的用户名</p>
<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"navbar-brand col-sm-3 col-md-2 mr-0"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"http://getbootstrap.com/docs/4.0/examples/dashboard/#"</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">"${session.loginUser}"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span><br></code></pre></td></tr></tbody></table></figure>



</li>
</ul>
<ul>
<li>验证结果</li>
</ul>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091454687.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="拦截器功能实现"><a href="#拦截器功能实现" class="headerlink" title="拦截器功能实现"></a>拦截器功能实现</h3><ul>
<li><p>LoginHandlerInterceptor</p>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.cutiebambi.config;<br><br><span class="hljs-keyword">import</span> org.springframework.boot.web.servlet.server.Session;<br><span class="hljs-keyword">import</span> org.springframework.util.StringUtils;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;<br><br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpSession;<br><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoginHandlerInterceptor</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">HandlerInterceptor</span> </span>{<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">preHandle</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="hljs-keyword">throws</span> Exception </span>{<br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">        //我写的代码</span><br><span class="hljs-comment">        if(!StringUtils.isEmpty(request.getParameter("userName")) &amp;&amp; request.getParameter("password").equals("1")){</span><br><span class="hljs-comment">            return true;</span><br><span class="hljs-comment">        }else{</span><br><span class="hljs-comment">            return false;</span><br><span class="hljs-comment">        }</span><br><span class="hljs-comment">        */</span><br><br>        <span class="hljs-comment">//老师的代码</span><br>        HttpSession session = request.getSession();<br>        <span class="hljs-keyword">if</span>(session.getAttribute(<span class="hljs-string">"loginUser"</span>) != <span class="hljs-keyword">null</span>){<br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;<br>        }<span class="hljs-keyword">else</span> {<br>            session.setAttribute(<span class="hljs-string">"msg"</span>, <span class="hljs-string">"用户名或者密码错误，我是从拦截器过来的提示信息"</span>);<span class="hljs-comment">// 感觉加上这行没什么作用</span><br>            request.getRequestDispatcher(<span class="hljs-string">"/index.html"</span>).forward(request,response);<span class="hljs-comment">//转发到index.html 显示提示信息</span><br>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;<br>        }<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>



</li>
</ul>
<ul>
<li>MyMvcConfig<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.cutiebambi.config;<br><br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;<br><span class="hljs-keyword">import</span> org.springframework.context.annotation.Configuration;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.HandlerInterceptor;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.LocaleResolver;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.InterceptorRegistry;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.ViewControllerRegistry;<br><span class="hljs-keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;<br><br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><br><span class="hljs-meta">@Configuration</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyMvcConfig</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">WebMvcConfigurer</span> </span>{<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addViewControllers</span><span class="hljs-params">(ViewControllerRegistry registry)</span> </span>{<br>        <span class="hljs-comment">//只需要访问http://localhost:8080/或者http://localhost:8080/index就可以跳转到index.html页面</span><br>        registry.addViewController(<span class="hljs-string">"/"</span>).setViewName(<span class="hljs-string">"index"</span>);<br>        registry.addViewController(<span class="hljs-string">"/index"</span>).setViewName(<span class="hljs-string">"index"</span>);<br>        registry.addViewController(<span class="hljs-string">"/index.html"</span>).setViewName(<span class="hljs-string">"index"</span>);<br>        registry.addViewController(<span class="hljs-string">"/main.html"</span>).setViewName(<span class="hljs-string">"dashboard"</span>);<br>    }<br><br>    <span class="hljs-comment">//将自定义的国际化组件放进Spring Boot里。</span><br>    <span class="hljs-meta">@Bean</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> LocaleResolver <span class="hljs-title">localeResolver</span><span class="hljs-params">()</span></span>{<br>        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> MyLocaleResolver();<br>    }<br><br>    <span class="hljs-comment">//拦截器</span><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">addInterceptors</span><span class="hljs-params">(InterceptorRegistry registry)</span> </span>{<br>        registry.addInterceptor(<span class="hljs-keyword">new</span> LoginHandlerInterceptor()).addPathPatterns(<span class="hljs-string">"/**"</span>).excludePathPatterns(<span class="hljs-string">"/"</span>, <span class="hljs-string">"/index.html"</span>, <span class="hljs-string">"/user/login"</span>, <span class="hljs-string">"/img/**"</span>, <span class="hljs-string">"/css/**"</span>, <span class="hljs-string">"/js/**"</span>);<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>



</li>
</ul>
<h2 id="展示员工列表"><a href="#展示员工列表" class="headerlink" title="展示员工列表"></a>展示员工列表</h2><h3 id="将公共代码抽取存放在commons-html里面"><a href="#将公共代码抽取存放在commons-html里面" class="headerlink" title="将公共代码抽取存放在commons.html里面"></a>将公共代码抽取存放在commons.html里面</h3><p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091744055.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091744203.png" srcset="/img/loading.gif" lazyload></p>
<h3 id="点击员工管理按钮-实现从后台获取员工列表数据并且在前台页面展示"><a href="#点击员工管理按钮-实现从后台获取员工列表数据并且在前台页面展示" class="headerlink" title="点击员工管理按钮,  实现从后台获取员工列表数据并且在前台页面展示"></a>点击员工管理按钮,  实现从后台获取员工列表数据并且在前台页面展示</h3><ul>
<li>新建一个EmployeeController</li>
</ul>
<figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> com.cutiebambi.controller;<br><br><span class="hljs-keyword">import</span> com.cutiebambi.dao.EmployeeDao;<br><span class="hljs-keyword">import</span> com.cutiebambi.pojo.Employee;<br><span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Autowired;<br><span class="hljs-keyword">import</span> org.springframework.stereotype.Controller;<br><span class="hljs-keyword">import</span> org.springframework.ui.Model;<br><span class="hljs-keyword">import</span> org.springframework.util.StringUtils;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;<br><span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestParam;<br><br><span class="hljs-keyword">import</span> javax.servlet.http.HttpSession;<br><span class="hljs-keyword">import</span> java.util.Collection;<br><br><span class="hljs-meta">@Controller</span><br><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">EmployeeController</span> </span>{<br>    <span class="hljs-meta">@Autowired</span><br>    <span class="hljs-keyword">private</span> EmployeeDao employeeDao;<br><br>    <span class="hljs-meta">@RequestMapping("/employee/getEmployees")</span><br>    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getEmployees</span><span class="hljs-params">(Model model)</span></span>{<br>        Collection&lt;Employee&gt; employees = employeeDao.getEmployees();<br>        model.addAttribute(<span class="hljs-string">"emps"</span>, employees);<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">"/emp/list"</span>;<br>    }<br>}<br></code></pre></td></tr></tbody></table></figure>



<ul>
<li>点击前台’员工管理’tab，调用这个方法</li>
</ul>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091748306.png" srcset="/img/loading.gif" lazyload></p>
<ul>
<li>前台接收并且解析获取到的数据<figure class="highlight html"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"row"</span>&gt;</span><br>    <span class="hljs-comment">&lt;!-- 侧边栏 --&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">th:replace</span>=<span class="hljs-string">"~{/commons/commons.html :: sidebar(active='list.html')}"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">main</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"main"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"col-md-9 ml-sm-auto col-lg-10 pt-3 px-4"</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>Section title<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"table-responsive"</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">table</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"table table-striped table-sm"</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">thead</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>id<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>lastName<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>email<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>gender<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>department<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>birth<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>action<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span><br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">thead</span>&gt;</span><br>                <span class="hljs-tag">&lt;<span class="hljs-name">tbody</span>&gt;</span><br>                    <span class="hljs-tag">&lt;<span class="hljs-name">tr</span> <span class="hljs-attr">th:each</span>=<span class="hljs-string">"employee : ${emps}"</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">"${employee.getId()}"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">"${employee.getLastName()}"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">"${employee.getEmail()}"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>                        <span class="hljs-comment">&lt;!-- 这里使用了三元运算符 --&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">"${employee.getGender()} == 0? '女' : '男'"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">"${employee.getDepartment().getDepartmentName()}"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>                        <span class="hljs-comment">&lt;!-- 格式化日期 --&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">td</span> <span class="hljs-attr">th:text</span>=<span class="hljs-string">"${#calendars.format(employee.getBirth(),'yyyy/MM/dd HH:mm:ss')}"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>                        <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span><br>                            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-sm btn-primary"</span>&gt;</span>增加<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>                            <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"btn btn-sm btn-danger"</span>&gt;</span>删除<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span><br>                        <span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span><br>                    <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span><br>                <span class="hljs-tag">&lt;/<span class="hljs-name">tbody</span>&gt;</span><br>            <span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></tbody></table></figure>







</li>
</ul>
<h3 id="侧边栏：根据点击的tab不同来实现动态高亮"><a href="#侧边栏：根据点击的tab不同来实现动态高亮" class="headerlink" title="侧边栏：根据点击的tab不同来实现动态高亮"></a>侧边栏：根据点击的tab不同来实现动态高亮</h3><p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091751551.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091751261.png" srcset="/img/loading.gif" lazyload></p>
<p><img src="https://raw.githubusercontent.com/xiaofanshutu/typora2022/main/202210091752792.png" srcset="/img/loading.gif" lazyload></p>
<h2 id="添加，修改与删除员工"><a href="#添加，修改与删除员工" class="headerlink" title="添加，修改与删除员工"></a>添加，修改与删除员工</h2><h2 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/wang_luwei/article/details/123652585">https://blog.csdn.net/wang_luwei/article/details/123652585</a></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/SpringBoot/" class="category-chain-item">SpringBoot</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Spring Boot</div>
      <div>https://xiaofanshutu.github.io/posts/a541262a.html</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>cutiebambi</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年4月29日</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/posts/a974f5b0.html" title="注解和反射">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">注解和反射</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/posts/e7a99a5e.html" title="CS61A">
                        <span class="hidden-mobile">CS61A</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>





  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
